{"version":3,"file":"index-BAlwJ-fz.js","sources":["../../src/app/constants.ts","../../src/app/state.ts","../../src/app/utils.ts","../../src/app/icons.ts","../../src/app/index.ts","../../src/main.ts"],"sourcesContent":["export const K = {\r\n  EXT: \"eic_ext\",\r\n  RAP: \"eic_rap\",\r\n  SES: \"eic_ses\",\r\n  LOGO: \"eic_logo\",\r\n  SET: \"eic_set\",\r\n  SEED: \"eic_seeded\",\r\n} as const;\r\n\r\nexport type Devise = { c: string; s: string };\r\n\r\nexport const DEVISES: Devise[] = [\r\n  { c: \"EUR\", s: \"€\" },\r\n  { c: \"USD\", s: \"$\" },\r\n  { c: \"GBP\", s: \"£\" },\r\n  { c: \"CDF\", s: \"FC\" },\r\n  { c: \"XAF\", s: \"FCFA\" },\r\n  { c: \"XOF\", s: \"CFA\" },\r\n  { c: \"NGN\", s: \"₦\" },\r\n  { c: \"ZAR\", s: \"R\" },\r\n  { c: \"KES\", s: \"KSh\" },\r\n  { c: \"GHS\", s: \"GH₵\" },\r\n  { c: \"TZS\", s: \"TSh\" },\r\n  { c: \"UGX\", s: \"USh\" },\r\n  { c: \"RWF\", s: \"RF\" },\r\n  { c: \"CHF\", s: \"CHF\" },\r\n  { c: \"CAD\", s: \"CA$\" },\r\n];\r\n\r\nexport type Extension = {\r\n  id: string;\r\n  nom: string;\r\n  couleur: string;\r\n  ville: string;\r\n  pays: string;\r\n  adresse: string;\r\n  dateCreation: string;\r\n  pasteur: { nom: string; email: string; tel: string };\r\n  coordinateur: string;\r\n  secretaire: string;\r\n  tresorier: string;\r\n  password: string;\r\n  devise: string;\r\n  symbole: string;\r\n};\r\n\r\nexport const DEF_EXTS: Extension[] = [\r\n  {\r\n    id: \"ext_nic\",\r\n    nom: \"Nicosie Centre\",\r\n    couleur: \"#8B5CF6\",\r\n    ville: \"Nicosie\",\r\n    pays: \"Chypre\",\r\n    adresse: \"12 Avenue de la Paix, Nicosie\",\r\n    dateCreation: \"2018-03-15\",\r\n    pasteur: {\r\n      nom: \"Pasteur Emmanuel Kabila\",\r\n      email: \"e.kabila@eic.cy\",\r\n      tel: \"+357 99 123 456\",\r\n    },\r\n    coordinateur: \"Frère David Mutombo\",\r\n    secretaire: \"Sœur Rachel Lukusa\",\r\n    tresorier: \"Frère Jean-Paul Ngoy\",\r\n    password: \"nic123\",\r\n    devise: \"EUR\",\r\n    symbole: \"€\",\r\n  },\r\n  {\r\n    id: \"ext_lim\",\r\n    nom: \"Limassol Sud\",\r\n    couleur: \"#059669\",\r\n    ville: \"Limassol\",\r\n    pays: \"Chypre\",\r\n    adresse: \"45 Rue des Flamboyants, Limassol\",\r\n    dateCreation: \"2019-07-20\",\r\n    pasteur: {\r\n      nom: \"Pasteur Pierre Kabasele\",\r\n      email: \"p.kabasele@eic.cy\",\r\n      tel: \"+357 99 654 321\",\r\n    },\r\n    coordinateur: \"Frère Samuel Banza\",\r\n    secretaire: \"Sœur Esther Mwamba\",\r\n    tresorier: \"Frère Isaac Tshimanga\",\r\n    password: \"lim123\",\r\n    devise: \"EUR\",\r\n    symbole: \"€\",\r\n  },\r\n  {\r\n    id: \"ext_lar\",\r\n    nom: \"Larnaca Est\",\r\n    couleur: \"#DC2626\",\r\n    ville: \"Larnaca\",\r\n    pays: \"Chypre\",\r\n    adresse: \"8 Boulevard du Lac, Larnaca\",\r\n    dateCreation: \"2020-01-10\",\r\n    pasteur: {\r\n      nom: \"Pasteur Daniel Nzamba\",\r\n      email: \"d.nzamba@eic.cy\",\r\n      tel: \"+357 99 789 012\",\r\n    },\r\n    coordinateur: \"Frère Caleb Mbombo\",\r\n    secretaire: \"Sœur Miriam Kavula\",\r\n    tresorier: \"Frère Thomas Luzolo\",\r\n    password: \"lar123\",\r\n    devise: \"EUR\",\r\n    symbole: \"€\",\r\n  },\r\n];\r\n\r\nexport type NavGroup = {\r\n  g: string;\r\n  items: { icon: string; lbl: string; path: string }[];\r\n};\r\n\r\nexport const ADMIN_NAV: NavGroup[] = [\n  {\n    g: \"Général\",\n    items: [\n      { icon: \"dashboard\", lbl: \"Tableau de Bord\", path: \"/admin/dashboard\" },\n      { icon: \"building\", lbl: \"Extensions\", path: \"/admin/extensions\" },\n      { icon: \"fileText\", lbl: \"Tous les Rapports\", path: \"/admin/rapports\" },\n      { icon: \"chartBar\", lbl: \"Bilans Comparatifs\", path: \"/admin/bilans\" },\n      { icon: \"users\", lbl: \"Nouveaux Convertis\", path: \"/admin/convertis\" },\n    ],\n  },\n  { g: \"Administration\", items: [{ icon: \"settings\", lbl: \"Paramètres\", path: \"/admin/settings\" }] },\n];\n\nexport const EXT_NAV: NavGroup[] = [\n  {\n    g: \"Mon Extension\",\n    items: [\n      { icon: \"dashboard\", lbl: \"Tableau de Bord\", path: \"/ext/dashboard\" },\n      { icon: \"plus\", lbl: \"Nouveau Rapport\", path: \"/ext/new\" },\n      { icon: \"fileText\", lbl: \"Mes Rapports\", path: \"/ext/rapports\" },\n      { icon: \"chartBar\", lbl: \"Bilans\", path: \"/ext/bilans\" },\n      { icon: \"users\", lbl: \"Convertis\", path: \"/ext/convertis\" },\n    ],\n  },\n];\n\r\nexport const STEPS = [\"Culte\", \"Effectif\", \"Offrandes\", \"Dépenses\", \"Convertis\", \"Signature\"] as const;\r\n\r\n","import { DEF_EXTS, K, type Extension } from \"./constants\";\r\n\r\nexport type RapportDepense = { motif: string; montant: number };\r\nexport type RapportConverti = { nom: string; tel?: string };\r\nexport type Rapport = {\r\n  id: string;\r\n  extensionId: string;\r\n  date: string;\r\n  heureDebut?: string;\r\n  heureFin?: string;\r\n  moderateur?: string;\r\n  predicateur?: string;\r\n  interprete?: string;\r\n  theme?: string;\r\n  textes?: string;\r\n  effectif?: { papas: number; mamans: number; freres: number; soeurs: number; enfants: number; total: number };\r\n  offrandes?: { ordinaires: number; orateur: number; dimes: number; actionsGrace: number; total: number };\r\n  ventilation?: { dixPctDime: number; dixPctSocial: number; reste: number };\r\n  depenses?: RapportDepense[];\r\n  totalDepenses?: number;\r\n  soldeFinal?: number;\r\n  nouveaux?: RapportConverti[];\r\n  signatures?: { secretaire: string; tresorier: string; pasteur: string };\r\n  updatedAt?: string;\r\n};\r\n\r\nexport type Session = { role: \"admin\" } | { role: \"extension\"; extId: string };\r\n\r\nexport type Settings = { nom: string; adminPw: string };\r\n\r\nexport function seedIfNeeded(): void {\r\n  if (localStorage.getItem(K.SEED)) return;\r\n  localStorage.setItem(K.EXT, JSON.stringify(DEF_EXTS));\r\n\r\n  const raps: Rapport[] = [];\r\n  DEF_EXTS.forEach((ext) => {\r\n    [0, 1, 2, 3, 4].forEach((m) => {\r\n      [5, 12, 19, 26].forEach((day) => {\r\n        const dt = new Date(2025, m, day);\r\n        if (dt > new Date()) return;\r\n        const pres = 60 + Math.floor(Math.random() * 80);\r\n        const tot = 200 + Math.floor(Math.random() * 500);\r\n        const dimes = Math.floor(tot * 0.3),\r\n          ord = Math.floor(tot * 0.5),\r\n          or = Math.floor(tot * 0.1),\r\n          ag = tot - dimes - ord - or;\r\n        const nCount = Math.floor(Math.random() * 4);\r\n        const dep = Math.floor(tot * 0.3);\r\n        raps.push({\r\n          id: `r_${ext.id}_${m}_${day}`,\r\n          extensionId: ext.id,\r\n          date: dt.toISOString().split(\"T\")[0],\r\n          heureDebut: \"09:00\",\r\n          heureFin: \"12:00\",\r\n          moderateur: ext.coordinateur,\r\n          predicateur: ext.pasteur.nom,\r\n          interprete: \"\",\r\n          theme: \"La Grâce de Dieu\",\r\n          textes: \"Jean 3:16\",\r\n          effectif: {\r\n            papas: Math.floor(pres * 0.2),\r\n            mamans: Math.floor(pres * 0.25),\r\n            freres: Math.floor(pres * 0.2),\r\n            soeurs: Math.floor(pres * 0.25),\r\n            enfants: Math.floor(pres * 0.1),\r\n            total: pres,\r\n          },\r\n          offrandes: { ordinaires: ord, orateur: or, dimes, actionsGrace: ag, total: tot },\r\n          ventilation: {\r\n            dixPctDime: +Number(dimes * 0.1).toFixed(2),\r\n            dixPctSocial: +Number(tot * 0.1).toFixed(2),\r\n            reste: +Number(tot * 0.8).toFixed(2),\r\n          },\r\n          depenses: [\r\n            { motif: \"Transport\", montant: Math.floor(dep * 0.4) },\r\n            { motif: \"Collation\", montant: Math.floor(dep * 0.3) },\r\n            { motif: \"Fournitures\", montant: Math.floor(dep * 0.3) },\r\n          ],\r\n          totalDepenses: dep,\r\n          soldeFinal: tot - dep,\r\n          nouveaux: Array.from({ length: nCount }, (_, i) => ({\r\n            nom: `Nouveau ${i + 1} (${ext.nom})`,\r\n            tel: \"+357 99 \" + String(100000 + Math.floor(Math.random() * 900000)),\r\n          })),\r\n          signatures: { secretaire: ext.secretaire, tresorier: ext.tresorier, pasteur: ext.pasteur.nom },\r\n          updatedAt: new Date().toISOString(),\r\n        });\r\n      });\r\n    });\r\n  });\r\n  localStorage.setItem(K.RAP, JSON.stringify(raps));\r\n  localStorage.setItem(K.SEED, \"1\");\r\n}\r\n\r\nexport const Store = {\r\n  // Extensions\r\n  getExts(): Extension[] {\r\n    try {\r\n      return JSON.parse(localStorage.getItem(K.EXT) || \"null\") || DEF_EXTS;\r\n    } catch {\r\n      return DEF_EXTS;\r\n    }\r\n  },\r\n  getExt(id: string): Extension | null {\r\n    return this.getExts().find((e) => e.id === id) || null;\r\n  },\r\n  saveExt(ext: Extension): void {\r\n    const a = this.getExts();\r\n    const i = a.findIndex((e) => e.id === ext.id);\r\n    if (i >= 0) a[i] = ext;\r\n    else a.push(ext);\r\n    localStorage.setItem(K.EXT, JSON.stringify(a));\r\n  },\r\n  delExt(id: string): void {\r\n    localStorage.setItem(\r\n      K.EXT,\r\n      JSON.stringify(this.getExts().filter((e) => e.id !== id)),\r\n    );\r\n    localStorage.setItem(\r\n      K.RAP,\r\n      JSON.stringify(this.getRaps().filter((r) => r.extensionId !== id)),\r\n    );\r\n  },\r\n\r\n  // Rapports\r\n  getRaps(extId: string | null = null): Rapport[] {\r\n    try {\r\n      const a: Rapport[] = JSON.parse(localStorage.getItem(K.RAP) || \"null\") || [];\r\n      return extId ? a.filter((r) => r.extensionId === extId) : a;\r\n    } catch {\r\n      return [];\r\n    }\r\n  },\r\n  getRap(id: string): Rapport | null {\r\n    return this.getRaps().find((r) => r.id === id) || null;\r\n  },\r\n  saveRap(r: Rapport): Rapport {\r\n    const a = this.getRaps();\r\n    const i = a.findIndex((x) => x.id === r.id);\r\n    r.updatedAt = new Date().toISOString();\r\n    if (i >= 0) a[i] = r;\r\n    else a.push(r);\r\n    localStorage.setItem(K.RAP, JSON.stringify(a));\r\n    return r;\r\n  },\r\n  delRap(id: string): void {\r\n    localStorage.setItem(\r\n      K.RAP,\r\n      JSON.stringify(this.getRaps().filter((r) => r.id !== id)),\r\n    );\r\n  },\r\n\r\n  // Session\r\n  getSes(): Session | null {\r\n    try {\r\n      return JSON.parse(localStorage.getItem(K.SES) || \"null\");\r\n    } catch {\r\n      return null;\r\n    }\r\n  },\r\n  setSes(s: Session): void {\r\n    localStorage.setItem(K.SES, JSON.stringify(s));\r\n  },\r\n  clearSes(): void {\r\n    localStorage.removeItem(K.SES);\r\n  },\r\n\r\n  // Logo\r\n  getLogo(): string | null {\r\n    return localStorage.getItem(K.LOGO) || null;\r\n  },\r\n  setLogo(d: string | null): void {\r\n    if (d) localStorage.setItem(K.LOGO, d);\r\n    else localStorage.removeItem(K.LOGO);\r\n  },\r\n\r\n  // Settings\r\n  getSet(): Settings {\r\n    try {\r\n      return JSON.parse(localStorage.getItem(K.SET) || \"null\") || { nom: \"Emerge in Christ\", adminPw: \"admin123\" };\r\n    } catch {\r\n      return { nom: \"Emerge in Christ\", adminPw: \"admin123\" };\r\n    }\r\n  },\r\n  saveSet(s: Settings): void {\r\n    localStorage.setItem(K.SET, JSON.stringify(s));\r\n  },\r\n\r\n  // Analytics\r\n  stats(extId: string | null = null): { cultes: number; presence: number; offrandes: number; nouveaux: number } {\r\n    const a = this.getRaps(extId);\r\n    const n = a.length;\r\n    return {\r\n      cultes: n,\r\n      presence: n ? Math.round(a.reduce((s, r) => s + (r.effectif?.total || 0), 0) / n) : 0,\r\n      offrandes: a.reduce((s, r) => s + (r.offrandes?.total || 0), 0),\r\n      nouveaux: a.reduce((s, r) => s + (r.nouveaux?.length || 0), 0),\r\n    };\r\n  },\r\n  monthly(\r\n    extId: string | null = null,\r\n    yr: number = new Date().getFullYear(),\r\n  ): { i: number; lbl: string; cultes: number; presence: number; offrandes: number; nouveaux: number }[] {\r\n    const a = this.getRaps(extId).filter((r) => new Date(r.date + \"T00:00\").getFullYear() === yr);\r\n    const m = Array.from({ length: 12 }, (_, i) => ({\r\n      i,\r\n      lbl: new Date(yr, i).toLocaleString(\"fr-FR\", { month: \"short\" }),\r\n      cultes: 0,\r\n      presence: 0,\r\n      offrandes: 0,\r\n      nouveaux: 0,\r\n    }));\r\n    a.forEach((r) => {\r\n      const mi = new Date(r.date + \"T00:00\").getMonth();\r\n      m[mi].cultes++;\r\n      m[mi].presence += r.effectif?.total || 0;\r\n      m[mi].offrandes += r.offrandes?.total || 0;\r\n      m[mi].nouveaux += r.nouveaux?.length || 0;\r\n    });\r\n    return m;\r\n  },\r\n  allNouveaux(extId: string | null = null): (RapportConverti & { date: string; extId: string; rapId: string })[] {\r\n    const a: (RapportConverti & { date: string; extId: string; rapId: string })[] = [];\r\n    this.getRaps(extId).forEach((r) =>\r\n      (r.nouveaux || []).forEach((n) => a.push({ ...n, date: r.date, extId: r.extensionId, rapId: r.id })),\r\n    );\r\n    return a;\r\n  },\r\n};\r\n\r\nexport const Auth = {\r\n  ses(): Session | null {\r\n    return Store.getSes();\r\n  },\r\n  isAdmin(): boolean {\r\n    const s = Store.getSes();\r\n    return s?.role === \"admin\";\r\n  },\r\n  isExt(): boolean {\r\n    const s = Store.getSes();\r\n    return s?.role === \"extension\";\r\n  },\r\n  loginAdmin(pw: string): boolean {\r\n    const cfg = Store.getSet();\r\n    if (pw === cfg.adminPw) {\r\n      Store.setSes({ role: \"admin\" });\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  loginExt(id: string, pw: string): boolean {\r\n    const e = Store.getExt(id);\r\n    if (e && e.password === pw) {\r\n      Store.setSes({ role: \"extension\", extId: e.id });\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  logout(): void {\r\n    Store.clearSes();\r\n  },\r\n};\r\n\r\n","export function fmt(v: unknown, sym = \"\"): string {\r\n  const n = typeof v === \"number\" ? v : parseFloat(String(v ?? \"\")) || 0;\r\n  return (\r\n    sym +\r\n    n.toLocaleString(\"fr-FR\", {\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2,\r\n    })\r\n  );\r\n}\r\n\r\nexport function fmtD(d?: string | null): string {\r\n  if (!d) return \"—\";\r\n  try {\r\n    return new Date(d + \"T00:00\").toLocaleDateString(\"fr-FR\", {\r\n      day: \"2-digit\",\r\n      month: \"long\",\r\n      year: \"numeric\",\r\n    });\r\n  } catch {\r\n    return d;\r\n  }\r\n}\r\n\r\nexport function uid(): string {\r\n  return \"r_\" + Date.now() + \"_\" + Math.random().toString(36).slice(2, 7);\r\n}\r\n\r\nexport function mName(m: number): string {\r\n  return new Date(2024, m).toLocaleString(\"fr-FR\", { month: \"long\" });\r\n}\r\n\r\nexport function hexRgb(h?: string | null): [number, number, number] {\r\n  if (!h || h.length < 7) return [124, 58, 237];\r\n  return [parseInt(h.slice(1, 3), 16), parseInt(h.slice(3, 5), 16), parseInt(h.slice(5, 7), 16)];\r\n}\r\n\r\nexport function esc(s?: string | null): string {\r\n  return (s || \"\").replace(/\"/g, \"&quot;\").replace(/</g, \"&lt;\");\r\n}\r\n\r\n","export const ICONS: Record<string, string> = {\n  dashboard: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"3\" y=\"3\" width=\"7\" height=\"9\"/><rect x=\"14\" y=\"3\" width=\"7\" height=\"5\"/><rect x=\"14\" y=\"12\" width=\"7\" height=\"9\"/><rect x=\"3\" y=\"16\" width=\"7\" height=\"5\"/></svg>`,\n  building: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"4\" y=\"2\" width=\"16\" height=\"20\" rx=\"2\" ry=\"2\"/><path d=\"M9 22v-4h6v4\"/><path d=\"M8 6h.01\"/><path d=\"M16 6h.01\"/><path d=\"M12 6h.01\"/><path d=\"M12 10h.01\"/><path d=\"M12 14h.01\"/><path d=\"M16 10h.01\"/><path d=\"M16 14h.01\"/><path d=\"M8 10h.01\"/><path d=\"M8 14h.01\"/></svg>`,\n  fileText: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/><polyline points=\"14 2 14 8 20 8\"/><line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"/><line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"/><polyline points=\"10 9 9 9 8 9\"/></svg>`,\n  chartBar: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"12\" y1=\"20\" x2=\"12\" y2=\"10\"/><line x1=\"18\" y1=\"20\" x2=\"18\" y2=\"4\"/><line x1=\"6\" y1=\"20\" x2=\"6\" y2=\"16\"/></svg>`,\n  users: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/><circle cx=\"9\" cy=\"7\" r=\"4\"/><path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"/><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"/></svg>`,\n  settings: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"3\"/><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"/></svg>`,\n  plus: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/></svg>`,\n  mapPin: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\"/><circle cx=\"12\" cy=\"10\" r=\"3\"/></svg>`,\n  user: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"/><circle cx=\"12\" cy=\"7\" r=\"4\"/></svg>`,\n  mail: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\"/><polyline points=\"22,6 12,13 2,6\"/></svg>`,\n  phone: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\"/></svg>`,\n  handshake: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"/><path d=\"M8 11h8\"/><path d=\"M8 15h8\"/></svg>`,\n  clipboard: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2\"/><rect x=\"8\" y=\"2\" width=\"8\" height=\"4\" rx=\"1\" ry=\"1\"/></svg>`,\n  trash: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"3 6 5 6 21 6\"/><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/></svg>`,\n  eye: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\"/><circle cx=\"12\" cy=\"12\" r=\"3\"/></svg>`,\n  file: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/><polyline points=\"14 2 14 8 20 8\"/></svg>`,\n  save: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\"/><polyline points=\"17 21 17 13 7 13 7 21\"/><polyline points=\"7 3 7 8 15 8\"/></svg>`,\n  download: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><polyline points=\"7 10 12 15 17 10\"/><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"/></svg>`,\n  upload: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><polyline points=\"17 8 12 3 7 8\"/><line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"/></svg>`,\n  folder: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z\"/></svg>`,\n  search: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"11\" cy=\"11\" r=\"8\"/><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"/></svg>`,\n  clock: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"10\"/><polyline points=\"12 6 12 12 16 14\"/></svg>`,\n  wallet: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"23\"/><path d=\"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\"/></svg>`,\n  userCheck: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"/><circle cx=\"8.5\" cy=\"7\" r=\"4\"/><polyline points=\"17 11 19 13 23 9\"/></svg>`,\n  pen: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 19l7-7 3 3-7 7-3-3z\"/><path d=\"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z\"/><path d=\"M2 2l7.586 7.586\"/><circle cx=\"11\" cy=\"11\" r=\"2\"/></svg>`,\n  cross: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 5.41L18.59 4 7 15.59V9H5v10h10v-2H8.41z\"/></svg>`,\n  x: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/></svg>`,\n  shield: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"/></svg>`,\n};\n\nexport function icon(name: string): string {\n  return ICONS[name] || ICONS.fileText;\n}\n","import { Store, Auth, seedIfNeeded, type Rapport, type Session } from \"./state\";\nimport { ADMIN_NAV, EXT_NAV, DEVISES, type Extension } from \"./constants\";\nimport { fmt, fmtD, uid, mName } from \"./utils\";\nimport { icon } from \"./icons\";\n\ndeclare global {\n  interface Window {\n    _charts: Record<string, any>;\n    switchTab: (tab: string) => void;\n    doLogin: (type: string) => void;\n    doLogout: () => void;\n    toggleSidebar: () => void;\n    navTo: (path: string, params?: Record<string, string>) => void;\n    curPath: () => string;\n    curParams: () => Record<string, string>;\n    openExtForm: (extId: string | null) => void;\n    saveExtForm: (extId: string) => void;\n    confirmDelExt: (id: string) => void;\n    onDevChange: () => void;\n    adminRapFilter: (sel: HTMLSelectElement, field: string) => void;\n    showRapModal: (id: string) => void;\n    doExportPDF: (id: string) => void;\n    doExportDOCX: (id: string) => void;\n    openRapForm: (rapId: string | null) => void;\n    saveRapForm: () => void;\n    addDepRow: () => void;\n    addConvRow: () => void;\n    removeDepRow: (idx: number) => void;\n    removeConvRow: (idx: number) => void;\n    updateRapTotals: () => void;\n    updateVentilation: () => void;\n    extRapFilter: (sel: HTMLSelectElement, field: string) => void;\n    doDeleteRap: (id: string) => void;\n    goToStep: (step: number) => void;\n  }\n}\n\nconst _routes: Record<string, (params: Record<string, string>) => void> = {};\n\nfunction regRoute(path: string, fn: (params: Record<string, string>) => void) {\n  _routes[path] = fn;\n}\n\nfunction navTo(path: string, params: Record<string, string> = {}) {\n  const q = Object.keys(params).length ? \"?\" + new URLSearchParams(params).toString() : \"\";\n  window.location.hash = path + q;\n}\n\nfunction curPath(): string {\n  return (window.location.hash.slice(1).split(\"?\")[0]) || \"/\";\n}\n\nfunction curParams(): Record<string, string> {\n  const [, q] = window.location.hash.slice(1).split(\"?\");\n  return q ? Object.fromEntries(new URLSearchParams(q)) : {};\n}\n\nfunction initRouter() {\n  const dispatch = () => {\n    const p = curPath();\n    const fn = _routes[p] || _routes[\"*\"];\n    if (fn) fn(curParams());\n  };\n  window.addEventListener(\"hashchange\", dispatch);\n  dispatch();\n}\n\nfunction setTopbar(title: string, sub: string = \"\", badge: string = \"\") {\n  document.getElementById(\"tb-title\")!.textContent = title;\n  document.getElementById(\"tb-sub\")!.textContent = sub || \"\";\n  document.getElementById(\"tb-badge\")!.textContent = badge || \"\";\n}\n\nfunction render(html: string) {\n  document.getElementById(\"page\")!.innerHTML = html;\n}\n\nfunction buildNav(def: typeof ADMIN_NAV) {\n  const nav = document.getElementById(\"sidebar-nav\")!;\n  nav.innerHTML = def\n    .map(\n      (g) =>\n        `<div class=\"nav-group\">${g.g}</div>${g.items\n          .map(\n            (it) =>\n              `<button class=\"nav-item\" data-path=\"${it.path}\" onclick=\"navTo('${it.path}')\"><span class=\"nav-icon\">${icon(it.icon)}</span>${it.lbl}</button>`\n          )\n          .join(\"\")}`\n    )\n    .join(\"\");\n}\n\nfunction setActive(path: string) {\n  document.querySelectorAll(\".nav-item\").forEach((el) => {\n    el.classList.toggle(\"active\", (el as HTMLElement).dataset.path === path);\n  });\n}\n\nfunction toast(msg: string, type: \"success\" | \"error\" = \"success\") {\n  const w = document.getElementById(\"toast-wrap\")!;\n  const el = document.createElement(\"div\");\n  el.className = `toast t-${type}`;\n  el.innerHTML = `<span>${type === \"success\" ? \"✓\" : \"✕\"}</span><span>${msg}</span>`;\n  w.appendChild(el);\n  setTimeout(() => {\n    el.style.animation = \"toastOut .3s ease forwards\";\n    setTimeout(() => el.remove(), 300);\n  }, 3200);\n}\n\nfunction openModal(html: string, large: boolean = false) {\n  document.getElementById(\"modal-root\")!.innerHTML = `\n    <div class=\"modal-backdrop\" onclick=\"if(event.target===this)closeModal()\">\n       <div class=\"modal${large ? \" modal-lg\" : \"\"}\">${html}</div>\n     </div>`;\n}\n\nfunction closeModal() {\n  document.getElementById(\"modal-root\")!.innerHTML = \"\";\n}\n\nfunction updateLogoUI() {\n  const logo = Store.getLogo();\n  const wrap = document.getElementById(\"sb-logo-wrap\")!;\n  if (logo) wrap.innerHTML = `<div class=\"logo-img-wrap\"><img src=\"${logo}\" alt=\"logo\"/></div>`;\n  else wrap.innerHTML = `<div class=\"logo-placeholder\">${icon(\"cross\")}</div>`;\n\n  const li = document.getElementById(\"login-icon\")!;\n  if (li) {\n    if (logo) li.innerHTML = `<img src=\"${logo}\" alt=\"logo\"/>`;\n    else li.innerHTML = icon(\"cross\");\n  }\n\n  const cfg = Store.getSet();\n  const sbn = document.getElementById(\"sb-community\")!;\n  if (sbn) sbn.textContent = cfg.nom || \"Emerge in Christ\";\n}\n\nfunction populateExtSel() {\n  const sel = document.getElementById(\"ext-select\") as HTMLSelectElement;\n  sel.innerHTML = Store.getExts()\n    .map((e) => `<option value=\"${e.id}\">${e.nom} — ${e.ville}</option>`)\n    .join(\"\");\n}\n\nfunction startApp() {\n  updateLogoUI();\n  document.getElementById(\"login-screen\")!.style.display = \"none\";\n  document.getElementById(\"app\")!.style.display = \"flex\";\n  const ses = Auth.ses()!;\n\n  if (Auth.isAdmin()) {\n    document.getElementById(\"sb-ext-name\")!.textContent = \"Administrateur Général\";\n    document.getElementById(\"sb-ext-role\")!.textContent = \"Accès réseau complet\";\n    buildNav(ADMIN_NAV);\n    registerAdminRoutes();\n    initRouter();\n    navTo(\"/admin/dashboard\");\n  } else {\n    const extSes = ses as { role: \"extension\"; extId: string };\n    const ext = Store.getExt(extSes.extId);\n    document.getElementById(\"sb-ext-name\")!.textContent = ext?.nom || \"—\";\n    document.getElementById(\"sb-ext-role\")!.textContent = ext?.ville || \"—\";\n    buildNav(EXT_NAV);\n    registerExtRoutes(extSes.extId);\n    initRouter();\n    navTo(\"/ext/dashboard\");\n  }\n}\n\nfunction statCard(iconName: string, label: string, value: string, sub: string) {\n  return `<div class=\"stat-card\"><div class=\"stat-label\">${label}</div><div class=\"stat-value\">${value}</div><div class=\"stat-sub\">${sub}</div><div class=\"stat-icon\">${icon(iconName)}</div></div>`;\n}\n\nfunction chartBar(id: string, labels: string[], data: number[], label: string, color: string) {\n  const ctx = (document.getElementById(id) as HTMLCanvasElement)?.getContext(\"2d\");\n  if (!ctx) return;\n  if (window._charts && window._charts[id]) window._charts[id].destroy();\n  if (!window._charts) window._charts = {};\n  window._charts[id] = new (window as any).Chart(ctx, {\n    type: \"bar\",\n    data: {\n      labels,\n      datasets: [{ label, data, backgroundColor: color, borderRadius: 5, borderSkipped: false }],\n    },\n    options: {\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: { legend: { display: false } },\n      scales: {\n        x: {\n          ticks: { color: \"#5A5280\", font: { family: \"'DM Sans', sans-serif\", size: 10 } },\n          grid: { color: \"rgba(90,82,128,.08)\" },\n        },\n        y: {\n          ticks: { color: \"#5A5280\", font: { family: \"'DM Sans', sans-serif\", size: 10 } },\n          grid: { color: \"rgba(90,82,128,.08)\" },\n        },\n      },\n    },\n  });\n}\n\nfunction chartLine(id: string, labels: string[], datasets: any[]) {\n  const ctx = (document.getElementById(id) as HTMLCanvasElement)?.getContext(\"2d\");\n  if (!ctx) return;\n  if (window._charts && window._charts[id]) window._charts[id].destroy();\n  if (!window._charts) window._charts = {};\n  window._charts[id] = new (window as any).Chart(ctx, {\n    type: \"line\",\n    data: { labels, datasets: datasets.map((d) => ({ ...d, tension: 0.4, fill: false })) },\n    options: {\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: { legend: { labels: { color: \"#A199C4\", font: { family: \"'DM Sans', sans-serif\", size: 11 } } } },\n      scales: { x: { ticks: { color: \"#5A5280\" } }, y: { ticks: { color: \"#5A5280\" } } },\n    },\n  });\n}\n\nfunction extCard(ext: Extension): string {\n  const s = Store.stats(ext.id);\n  return `<div class=\"ext-card\" style=\"--ext-color:${ext.couleur || \"#8B5CF6\"}\">\n    <div class=\"flex justify-between items-center mb-8\">\n      <div><div class=\"ext-card-name\">${ext.nom}</div><div class=\"ext-card-ville\">${icon(\"mapPin\")} ${ext.ville}, ${ext.pays}</div></div>\n      <div class=\"ext-card-pastor\">\n        ${icon(\"user\")} ${ext.pasteur?.nom || \"—\"}<br>${icon(\"mail\")} ${ext.pasteur?.email || \"—\"}<br>${icon(\"phone\")} ${ext.pasteur?.tel || \"—\"}\n      </div>\n      <div class=\"ext-card-team\">\n        ${icon(\"handshake\")} Coord: ${ext.coordinateur || \"—\"}<br>${icon(\"clipboard\")} Secrét: ${ext.secretaire || \"—\"}<br>${icon(\"wallet\")} Trésor: ${ext.tresorier || \"—\"}\n      </div>\n    <div class=\"text-xs text-muted mb-8\" style=\"line-height:1.8\">\n      ${icon(\"user\")} ${ext.pasteur?.nom || \"—\"}<br>${icon(\"mail\")} ${ext.pasteur?.email || \"—\"}<br>${icon(\"phone\")} ${ext.pasteur?.tel || \"—\"}\n    </div>\n    <div class=\"text-xs text-muted mb-12\" style=\"line-height:1.8\">\n      ${icon(\"handshake\")} Coord: ${ext.coordinateur || \"—\"}<br>${icon(\"clipboard\")} Secrét: ${ext.secretaire || \"—\"}<br>${icon(\"wallet\")} Trésor: ${ext.tresorier || \"—\"}\n    </div>\n    <div class=\"ext-mini-stats mb-12\">\n      <div><div class=\"ext-stat-val\">${s.cultes}</div><div class=\"ext-stat-lbl\">Cultes</div></div>\n      <div><div class=\"ext-stat-val\">${s.presence}</div><div class=\"ext-stat-lbl\">Moy.</div></div>\n      <div><div class=\"ext-stat-val\">${s.nouveaux}</div><div class=\"ext-stat-lbl\">Conv.</div></div>\n    </div>\n    <div class=\"flex gap-8\">\n      <button class=\"btn btn-secondary btn-sm\" onclick=\"openExtForm('${ext.id}')\">✏ Modifier</button>\n      <button class=\"btn btn-danger btn-sm\" onclick=\"confirmDelExt('${ext.id}')\">${icon(\"trash\")} Supprimer</button>\n    </div>\n  </div>`;\n}\n\nfunction rapTableRow(r: Rapport): string {\n  const ext = Store.getExt(r.extensionId);\n  return `<tr>\n    <td class=\"td-bold\">${fmtD(r.date)}</td>\n    <td><span class=\"badge\" style=\"background:${ext?.couleur || \"#8B5CF6\"}22;color:${ext?.couleur || \"#8B5CF6\"};border:1px solid ${ext?.couleur || \"#8B5CF6\"}44\">${ext?.nom || \"—\"}</span></td>\n    <td>${r.moderateur || \"—\"}</td>\n    <td>${r.effectif?.total || 0}</td>\n    <td>${fmt(r.offrandes?.total, ext?.symbole || \"€\")}</td>\n    <td>${r.nouveaux?.length || 0}</td>\n    <td>\n      <div class=\"flex gap-8\">\n        <button class=\"btn btn-secondary btn-sm btn-icon\" onclick=\"showRapModal('${r.id}')\" title=\"Voir\">${icon(\"eye\")}</button>\n        <button class=\"btn btn-gold btn-sm btn-icon\" onclick=\"doExportPDF('${r.id}')\" title=\"PDF\">${icon(\"file\")}</button>\n        <button class=\"btn btn-success btn-sm btn-icon\" onclick=\"doExportDOCX('${r.id}')\" title=\"DOCX\">${icon(\"pen\")}</button>\n      </div>\n    </td>\n  </tr>`;\n}\n\nfunction showRapModal(rapId: string) {\n  const r = Store.getRap(rapId);\n  if (!r) return;\n  const ext = Store.getExt(r.extensionId);\n  const sym = ext?.symbole || \"€\";\n  \n  openModal(`\n    <div class=\"modal-header\"><h2>Rapport du ${fmtD(r.date)}</h2><button class=\"modal-close\" onclick=\"closeModal()\">${icon(\"x\")}</button></div>\n    <div class=\"modal-body\">\n      <div class=\"grid-2 mb-12\">\n        <div class=\"calc-box\">\n          <div class=\"form-section-title\">Culte</div>\n          <div class=\"calc-row\"><span>Heure</span><span>${r.heureDebut || \"—\"} - ${r.heureFin || \"—\"}</span></div>\n          <div class=\"calc-row\"><span>Modérateur</span><span>${r.moderateur || \"—\"}</span></div>\n          <div class=\"calc-row\"><span>Prédicateur</span><span>${r.predicateur || \"—\"}</span></div>\n          <div class=\"calc-row\"><span>Thème</span><span>${r.theme || \"—\"}</span></div>\n          <div class=\"calc-row\"><span>Textes</span><span>${r.textes || \"—\"}</span></div>\n        </div>\n        <div class=\"calc-box\">\n          <div class=\"form-section-title\">Effectif</div>\n          <div class=\"calc-row\"><span>Papas</span><span>${r.effectif?.papas || 0}</span></div>\n          <div class=\"calc-row\"><span>Mamans</span><span>${r.effectif?.mamans || 0}</span></div>\n          <div class=\"calc-row\"><span>Frères</span><span>${r.effectif?.freres || 0}</span></div>\n          <div class=\"calc-row\"><span>Soeurs</span><span>${r.effectif?.soeurs || 0}</span></div>\n          <div class=\"calc-row\"><span>Enfants</span><span>${r.effectif?.enfants || 0}</span></div>\n          <div class=\"calc-row total-row\"><span>Total</span><span>${r.effectif?.total || 0}</span></div>\n        </div>\n      </div>\n      <div class=\"grid-2 mb-12\">\n        <div class=\"calc-box\">\n          <div class=\"form-section-title\">Offrandes (${sym})</div>\n          <div class=\"calc-row\"><span>Offrandes ordinaires</span><span>${fmt(r.offrandes?.ordinaires, sym)}</span></div>\n          <div class=\"calc-row\"><span>Offrande orateur</span><span>${fmt(r.offrandes?.orateur, sym)}</span></div>\n          <div class=\"calc-row\"><span>Dîmes</span><span>${fmt(r.offrandes?.dimes, sym)}</span></div>\n          <div class=\"calc-row\"><span>Actions de grâce</span><span>${fmt(r.offrandes?.actionsGrace, sym)}</span></div>\n          <div class=\"calc-row total-row\"><span>Total</span><span>${fmt(r.offrandes?.total, sym)}</span></div>\n        </div>\n        <div class=\"calc-box\">\n          <div class=\"form-section-title\">Ventilation (${sym})</div>\n          <div class=\"calc-row\"><span>10% Dîmes</span><span>${fmt(r.ventilation?.dixPctDime, sym)}</span></div>\n          <div class=\"calc-row\"><span>10% Social</span><span>${fmt(r.ventilation?.dixPctSocial, sym)}</span></div>\n          <div class=\"calc-row\"><span>Reste</span><span>${fmt(r.ventilation?.reste, sym)}</span></div>\n          <div class=\"calc-row\"><span>Dépenses</span><span>${fmt(r.totalDepenses, sym)}</span></div>\n          <div class=\"calc-row total-row\"><span>Solde final</span><span>${fmt(r.soldeFinal, sym)}</span></div>\n        </div>\n      </div>\n      ${r.depenses?.length ? `\n      <div class=\"form-section-title mb-8\">Dépenses</div>\n      <div class=\"table-wrap mb-12\">\n        <table><thead><tr><th>Motif</th><th>Montant</th></tr></thead>\n        <tbody>${r.depenses!.map(d => `<tr><td>${d.motif}</td><td>${fmt(d.montant, sym)}</td></tr>`).join(\"\")}</tbody></table>\n      </div>` : \"\"}\n      ${r.nouveaux?.length ? `\n      <div class=\"form-section-title mb-8\">Nouveaux convertis</div>\n      <div class=\"table-wrap mb-12\">\n        <table><thead><tr><th>Nom</th><th>Téléphone</th></tr></thead>\n        <tbody>${r.nouveaux!.map(n => `<tr><td>${n.nom}</td><td>${n.tel || \"—\"}</td></tr>`).join(\"\")}</tbody></table>\n      </div>` : \"\"}\n    </div>\n    <div class=\"modal-footer\">\n      <button class=\"btn btn-gold\" onclick=\"closeModal();doExportPDF('${r.id}')\">${icon(\"file\")} Exporter PDF</button>\n      <button class=\"btn btn-success\" onclick=\"closeModal();doExportDOCX('${r.id}')\">${icon(\"pen\")} Exporter DOCX</button>\n    </div>\n  `);\n}\n\nfunction doExportPDF(rapId: string) {\n  const r = Store.getRap(rapId);\n  if (!r) return;\n  const ext = Store.getExt(r.extensionId);\n  const sym = ext?.symbole || \"€\";\n\n  const { jsPDF } = (window as any).jspdf;\n  const doc = new jsPDF();\n  const pageWidth = doc.internal.pageSize.getWidth();\n\n  doc.setFontSize(18);\n  doc.text(\"RAPPORT DE CULTE\", pageWidth / 2, 20, { align: \"center\" });\n  doc.setFontSize(12);\n  doc.text(ext?.nom || \"Emerge in Christ\", pageWidth / 2, 28, { align: \"center\" });\n  doc.text(`Date: ${fmtD(r.date)}`, pageWidth / 2, 34, { align: \"center\" });\n\n  let y = 50;\n  doc.setFontSize(11);\n  doc.setFont(\"helvetica\", \"bold\");\n  doc.text(\"INFORMATIONS DU CULTE\", 15, y);\n  y += 8;\n  doc.setFont(\"helvetica\", \"normal\");\n  doc.text(`Heure: ${r.heureDebut || \"—\"} - ${r.heureFin || \"—\"}`, 15, y);\n  y += 6;\n  doc.text(`Modérateur: ${r.moderateur || \"—\"}`, 15, y);\n  y += 6;\n  doc.text(`Prédicateur: ${r.predicateur || \"—\"}`, 15, y);\n  y += 6;\n  doc.text(`Interprète: ${r.interprete || \"—\"}`, 15, y);\n  y += 6;\n  doc.text(`Thème: ${r.theme || \"—\"}`, 15, y);\n  y += 6;\n  doc.text(`Textes: ${r.textes || \"—\"}`, 15, y);\n\n  y += 12;\n  doc.setFont(\"helvetica\", \"bold\");\n  doc.text(\"EFFECTIF\", 15, y);\n  y += 8;\n  doc.setFont(\"helvetica\", \"normal\");\n  doc.text(`Papas: ${r.effectif?.papas || 0} | Mamans: ${r.effectif?.mamans || 0} | Frères: ${r.effectif?.freres || 0} | Soeurs: ${r.effectif?.soeurs || 0} | Enfants: ${r.effectif?.enfants || 0}`, 15, y);\n  y += 6;\n  doc.text(`Total présence: ${r.effectif?.total || 0}`, 15, y);\n\n  y += 12;\n  doc.setFont(\"helvetica\", \"bold\");\n  doc.text(\"OFFRANDES\", 15, y);\n  y += 8;\n  doc.setFont(\"helvetica\", \"normal\");\n  doc.text(`Offrandes ordinaires: ${fmt(r.offrandes?.ordinaires, sym)}`, 15, y);\n  y += 6;\n  doc.text(`Offrande orateur: ${fmt(r.offrandes?.orateur, sym)}`, 15, y);\n  y += 6;\n  doc.text(`Dîmes: ${fmt(r.offrandes?.dimes, sym)}`, 15, y);\n  y += 6;\n  doc.text(`Actions de grâce: ${fmt(r.offrandes?.actionsGrace, sym)}`, 15, y);\n  y += 6;\n  doc.setFont(\"helvetica\", \"bold\");\n  doc.text(`TOTAL: ${fmt(r.offrandes?.total, sym)}`, 15, y);\n\n  y += 12;\n  doc.setFont(\"helvetica\", \"bold\");\n  doc.text(\"VENTILATION\", 15, y);\n  y += 8;\n  doc.setFont(\"helvetica\", \"normal\");\n  doc.text(`10% des dîmes: ${fmt(r.ventilation?.dixPctDime, sym)}`, 15, y);\n  y += 6;\n  doc.text(`10% social: ${fmt(r.ventilation?.dixPctSocial, sym)}`, 15, y);\n  y += 6;\n  doc.text(`Reste: ${fmt(r.ventilation?.reste, sym)}`, 15, y);\n\n  y += 12;\n  doc.setFont(\"helvetica\", \"bold\");\n  doc.text(\"DÉPENSES\", 15, y);\n  y += 8;\n  doc.setFont(\"helvetica\", \"normal\");\n  if (r.depenses?.length) {\n    r.depenses.forEach((d) => {\n      doc.text(`- ${d.motif}: ${fmt(d.montant, sym)}`, 15, y);\n      y += 6;\n    });\n    doc.setFont(\"helvetica\", \"bold\");\n    doc.text(`Total dépenses: ${fmt(r.totalDepenses, sym)}`, 15, y);\n    doc.setFont(\"helvetica\", \"normal\");\n    y += 6;\n    doc.text(`Solde final: ${fmt(r.soldeFinal, sym)}`, 15, y);\n  } else {\n    doc.text(\"Aucune dépense\", 15, y);\n  }\n\n  if (r.nouveaux?.length) {\n    y += 12;\n    doc.setFont(\"helvetica\", \"bold\");\n    doc.text(\"NOUVEAUX CONVERTIS\", 15, y);\n    y += 8;\n    doc.setFont(\"helvetica\", \"normal\");\n    r.nouveaux.forEach((n) => {\n      doc.text(`- ${n.nom}${n.tel ? ` (${n.tel})` : \"\"}`, 15, y);\n      y += 6;\n    });\n  }\n\n  y += 15;\n  doc.setFont(\"helvetica\", \"bold\");\n  doc.text(\"SIGNATURES\", 15, y);\n  y += 15;\n  doc.setFont(\"helvetica\", \"normal\");\n  doc.text(`Secrétaire: ___________________`, 15, y);\n  doc.text(`Trésorier: ___________________`, 80, y);\n  doc.text(`Pasteur: ___________________`, 145, y);\n\n  doc.save(`Rapport_${ext?.nom || \"EIC\"}_${r.date}.pdf`);\n  toast(\"PDF exporté avec succès\", \"success\");\n}\n\nasync function doExportDOCX(rapId: string) {\n  const r = Store.getRap(rapId);\n  if (!r) return;\n  const ext = Store.getExt(r.extensionId);\n  const sym = ext?.symbole || \"€\";\n\n  const { Document, Packer, Paragraph, TextRun, Table, TableRow, TableCell, WidthType, AlignmentType, BorderStyle } = (window as any).docx;\n\n  const tableRows = [\n    new TableRow({\n      children: [\n        new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: \"Catégorie\", bold: true })] })] }),\n        new TableCell({ children: [new Paragraph({ children: [new TextRun({ text: \"Détails\", bold: true })] })] }),\n      ],\n    }),\n    new TableRow({\n      children: [\n        new TableCell({ children: [new Paragraph(\"Heure\")] }),\n        new TableCell({ children: [new Paragraph(`${r.heureDebut || \"—\"} - ${r.heureFin || \"—\"}`)] }),\n      ],\n    }),\n    new TableRow({\n      children: [\n        new TableCell({ children: [new Paragraph(\"Modérateur\")] }),\n        new TableCell({ children: [new Paragraph(r.moderateur || \"—\")] }),\n      ],\n    }),\n    new TableRow({\n      children: [\n        new TableCell({ children: [new Paragraph(\"Prédicateur\")] }),\n        new TableCell({ children: [new Paragraph(r.predicateur || \"—\")] }),\n      ],\n    }),\n    new TableRow({\n      children: [\n        new TableCell({ children: [new Paragraph(\"Thème\")] }),\n        new TableCell({ children: [new Paragraph(r.theme || \"—\")] }),\n      ],\n    }),\n    new TableRow({\n      children: [\n        new TableCell({ children: [new Paragraph(\"Total présence\")] }),\n        new TableCell({ children: [new Paragraph(String(r.effectif?.total || 0))] }),\n      ],\n    }),\n    new TableRow({\n      children: [\n        new TableCell({ children: [new Paragraph(\"Total offrandes\")] }),\n        new TableCell({ children: [new Paragraph(fmt(r.offrandes?.total, sym))] }),\n      ],\n    }),\n  ];\n\n  const doc = new Document({\n    sections: [\n      {\n        properties: {},\n        children: [\n          new Paragraph({ children: [new TextRun({ text: \"RAPPORT DE CULTE\", bold: true, size: 48 })], alignment: AlignmentType.CENTER }),\n          new Paragraph({ children: [new TextRun(ext?.nom || \"Emerge in Christ\")] }),\n          new Paragraph({ children: [new TextRun(`Date: ${fmtD(r.date)}`)], alignment: AlignmentType.CENTER }),\n          new Paragraph({ children: [new TextRun({ text: \"\" })] }),\n          new Table({ rows: tableRows }),\n        ],\n      },\n    ],\n  });\n\n  const blob = await Packer.toBlob(doc);\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement(\"a\");\n  a.href = url;\n  a.download = `Rapport_${ext?.nom || \"EIC\"}_${r.date}.docx`;\n  a.click();\n  URL.revokeObjectURL(url);\n  toast(\"DOCX exporté avec succès\", \"success\");\n}\n\nfunction registerAdminRoutes() {\n  regRoute(\"/admin/dashboard\", pgAdminDash);\n  regRoute(\"/admin/extensions\", pgAdminExts);\n  regRoute(\"/admin/rapports\", pgAdminRaps);\n  regRoute(\"/admin/bilans\", pgAdminBilans);\n  regRoute(\"/admin/convertis\", pgAdminConvertis);\n  regRoute(\"/admin/settings\", pgAdminSettings);\n  regRoute(\"*\", () => navTo(\"/admin/dashboard\"));\n  window.addEventListener(\"hashchange\", () => setActive(curPath()));\n}\n\nfunction registerExtRoutes(extId: string) {\n  regRoute(\"/ext/dashboard\", () => pgExtDash(extId));\n  regRoute(\"/ext/new\", () => pgExtNew(extId));\n  regRoute(\"/ext/rapports\", pgExtRaps);\n  regRoute(\"/ext/bilans\", () => pgExtBilans(extId));\n  regRoute(\"/ext/convertis\", () => pgExtConvertis(extId));\n  regRoute(\"*\", () => navTo(\"/ext/dashboard\"));\n  window.addEventListener(\"hashchange\", () => setActive(curPath()));\n}\n\nfunction pgAdminDash() {\n  setActive(\"/admin/dashboard\");\n  const cfg = Store.getSet();\n  const exts = Store.getExts();\n  const st = Store.stats();\n  const mo = Store.monthly(null, new Date().getFullYear());\n  setTopbar(\"Tableau de Bord Global\", \"Vue d'ensemble du réseau\", \"Admin\");\n\n  const maxC = Math.max(1, ...exts.map((e) => Store.stats(e.id).cultes));\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Vue Générale</h1><p>${cfg.nom || \"Emerge in Christ\"} · ${exts.length} extension(s)</p></div>\n      <button class=\"btn btn-secondary btn-sm\" onclick=\"navTo('/admin/extensions')\">${icon(\"settings\")} Gérer</button>\n    </div>\n    <div class=\"grid-4 mb-20\">\n      ${statCard(\"building\", \"Extensions\", String(exts.length), \"Sites actifs\")}\n      ${statCard(\"fileText\", \"Cultes\", String(st.cultes), \"Total réseau\")}\n      ${statCard(\"users\", \"Présence moy.\", String(st.presence), \"Par culte\")}\n      ${statCard(\"userCheck\", \"Convertis\", String(st.nouveaux), \"Total réseau\")}\n    </div>\n    <div class=\"grid-2 mb-20\">\n      <div class=\"card\"><div class=\"form-section-title mb-12\">Présence mensuelle ${new Date().getFullYear()}</div><div class=\"chart-wrap\"><canvas id=\"chP\"></canvas></div></div>\n      <div class=\"card\"><div class=\"form-section-title mb-12\">Offrandes mensuelles ${new Date().getFullYear()}</div><div class=\"chart-wrap\"><canvas id=\"chO\"></canvas></div></div>\n    </div>\n    <div class=\"form-section-title mb-12\">Performance par Extension</div>\n    <div class=\"grid-3\">\n      ${exts\n        .map((ext) => {\n          const s = Store.stats(ext.id);\n          return `<div class=\"ext-card\" style=\"--ext-color:${ext.couleur}\">\n            <div class=\"ext-card-name\">${ext.nom}</div>\n            <div class=\"ext-card-ville\">${icon(\"mapPin\")} ${ext.ville}, ${ext.pays}</div>\n            <div class=\"ext-mini-stats mb-12\">\n              <div><div class=\"ext-stat-val\">${s.cultes}</div><div class=\"ext-stat-lbl\">Cultes</div></div>\n              <div><div class=\"ext-stat-val\">${s.presence}</div><div class=\"ext-stat-lbl\">Moy.</div></div>\n              <div><div class=\"ext-stat-val\">${s.nouveaux}</div><div class=\"ext-stat-lbl\">Conv.</div></div>\n            </div>\n            <div class=\"text-xs text-muted mb-4\">Activité relative</div>\n            <div class=\"progress-bar\"><div class=\"progress-fill\" style=\"width:${Math.round((s.cultes / maxC) * 100)}%;background:${ext.couleur}\"></div></div>\n          </div>`;\n        })\n        .join(\"\")}\n    </div>\n  `);\n\n  const lb = mo.map((m) => m.lbl);\n  chartBar(\"chP\", lb, mo.map((m) => m.presence), \"Présence\", \"rgba(139,92,246,.7)\");\n  chartBar(\"chO\", lb, mo.map((m) => m.offrandes), \"Offrandes\", \"rgba(245,158,11,.7)\");\n}\n\nfunction pgAdminExts() {\n  setActive(\"/admin/extensions\");\n  setTopbar(\"Extensions\", \"Gestion du réseau\", \"Admin\");\n  const exts = Store.getExts();\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Extensions</h1><p>${exts.length} extension(s)</p></div>\n      <button class=\"btn btn-primary\" onclick=\"openExtForm(null)\">${icon(\"plus\")} Nouvelle Extension</button>\n    </div>\n    <div class=\"grid-auto\">${exts.map(extCard).join(\"\")}</div>\n  `);\n}\n\nfunction pgAdminRaps(params: Record<string, string> = {}) {\n  setActive(\"/admin/rapports\");\n  setTopbar(\"Tous les Rapports\", \"Réseau complet\", \"Admin\");\n  const exts = Store.getExts();\n  const fExt = params.ext || \"\";\n  const fMonth = params.month !== undefined && params.month !== \"\" ? parseInt(params.month) : -1;\n  const fYear = params.year ? parseInt(params.year) : 0;\n\n  let raps = Store.getRaps(fExt || null);\n  if (fMonth >= 0) raps = raps.filter((r) => new Date(r.date + \"T00:00\").getMonth() === fMonth);\n  if (fYear) raps = raps.filter((r) => new Date(r.date + \"T00:00\").getFullYear() === fYear);\n  raps.sort((a, b) => b.date.localeCompare(a.date));\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Rapports de Culte</h1><p>${raps.length} rapport(s)</p></div>\n    </div>\n    <div class=\"filter-bar\">\n      <select onchange=\"adminRapFilter(this,'ext')\">\n        <option value=\"\">— Toutes les extensions —</option>\n        ${exts.map((e) => `<option value=\"${e.id}\"${fExt === e.id ? \" selected\" : \"\"}>${e.nom}</option>`).join(\"\")}\n      </select>\n      <select onchange=\"adminRapFilter(this,'month')\">\n        <option value=\"\">— Tous les mois —</option>\n        ${Array.from({ length: 12 }, (_, i) => `<option value=\"${i}\"${fMonth === i ? \" selected\" : \"\"}>${mName(i)}</option>`).join(\"\")}\n      </select>\n      <select onchange=\"adminRapFilter(this,'year')\">\n        <option value=\"\">— Toutes années —</option>\n        ${[2026, 2025, 2024, 2023].map((y) => `<option value=\"${y}\"${fYear === y ? \" selected\" : \"\"}>${y}</option>`).join(\"\")}\n      </select>\n    </div>\n    <div class=\"table-wrap\">\n      <table>\n        <thead><tr><th>Date</th><th>Extension</th><th>Modérateur</th><th>Présence</th><th>Offrandes</th><th>Convertis</th><th>Actions</th></tr></thead>\n        <tbody>\n          ${raps.length === 0 ? `<tr><td colspan=\"7\" style=\"text-align:center;padding:32px;color:var(--text3)\">Aucun rapport trouvé</td></tr>` : \"\"}\n          ${raps.map(rapTableRow).join(\"\")}\n        </tbody>\n      </table>\n    </div>`);\n}\n\nfunction pgAdminBilans() {\n  setActive(\"/admin/bilans\");\n  setTopbar(\"Bilans Comparatifs\", \"Analyse et synthèse\", \"Admin\");\n  const exts = Store.getExts();\n  const yr = new Date().getFullYear();\n  const mo = Store.monthly(null, yr);\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Bilans Comparatifs</h1><p>${exts.length} extensions · ${yr}</p></div>\n    </div>\n    <div class=\"grid-3 mb-20\">\n      ${exts\n        .map((ext) => {\n          const s = Store.stats(ext.id);\n          return `<div class=\"card\" style=\"border-left:3px solid ${ext.couleur}\">\n            <div class=\"flex justify-between items-center mb-12\">\n              <div class=\"font-bold\">${ext.nom}</div>\n              <span class=\"badge badge-purple\">${ext.symbole}</span>\n            </div>\n            <div class=\"calc-box\">\n              <div class=\"calc-row\"><span>Cultes</span><span>${s.cultes}</span></div>\n              <div class=\"calc-row\"><span>Présence moy.</span><span>${s.presence}</span></div>\n              <div class=\"calc-row\"><span>Offrandes</span><span>${fmt(s.offrandes, ext.symbole)}</span></div>\n              <div class=\"calc-row total-row\"><span>Convertis</span><span>${s.nouveaux}</span></div>\n            </div>\n          </div>`;\n        })\n        .join(\"\")}\n    </div>\n    <div class=\"card mb-20\">\n      <div class=\"form-section-title mb-12\">Présence comparative par mois (${yr})</div>\n      <div class=\"chart-wrap\" style=\"height:260px\"><canvas id=\"chCmp\"></canvas></div>\n    </div>\n    <div class=\"form-section-title mb-12\">Tableau comparatif mensuel</div>\n    <div class=\"table-wrap\">\n      <table>\n        <thead><tr><th>Mois</th>${exts.map((e) => `<th>${e.nom}</th>`).join(\"\")}<th>Total</th></tr></thead>\n        <tbody>\n          ${mo\n            .map((m) => {\n              const vals = exts.map((ext) => Store.monthly(ext.id, yr)[m.i].presence);\n              const tot = vals.reduce((a, b) => a + b, 0);\n              return `<tr><td class=\"td-bold\">${m.lbl} ${yr}</td>${vals.map((v) => `<td>${v || 0}</td>`).join(\"\")}<td class=\"td-bold\">${tot}</td></tr>`;\n            })\n            .join(\"\")}\n        </tbody>\n      </table>\n    </div>\n  `);\n\n  const datasets = exts.map((ext) => ({\n    label: ext.nom,\n    data: Store.monthly(ext.id, yr).map((m) => m.presence),\n    borderColor: ext.couleur,\n    backgroundColor: ext.couleur + \"44\",\n  }));\n  chartLine(\"chCmp\", mo.map((m) => m.lbl), datasets);\n}\n\nfunction pgAdminConvertis() {\n  setActive(\"/admin/convertis\");\n  setTopbar(\"Nouveaux Convertis\", \"Suivi pastoral\", \"Admin\");\n  const exts = Store.getExts();\n  const convertis = Store.allNouveaux();\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Nouveaux Convertis</h1><p>${convertis.length} converti(s) enregistré(s)</p></div>\n    </div>\n    <div class=\"filter-bar mb-20\">\n      <select id=\"conv-ext-filter\" onchange=\"this.dataset.v=this.value;pgAdminConvertis()\">\n        <option value=\"\">— Toutes les extensions —</option>\n        ${exts.map((e) => `<option value=\"${e.id}\">${e.nom}</option>`).join(\"\")}\n      </select>\n    </div>\n    <div class=\"table-wrap\">\n      <table>\n        <thead><tr><th>Date</th><th>Extension</th><th>Nom</th><th>Téléphone</th><th>Actions</th></tr></thead>\n        <tbody>\n          ${convertis.length === 0 ? `<tr><td colspan=\"5\" style=\"text-align:center;padding:32px;color:var(--text3)\">Aucun converti enregistré</td></tr>` : \"\"}\n          ${convertis\n            .map((c) => {\n              const ext = Store.getExt(c.extId);\n              return `<tr>\n                <td class=\"td-bold\">${fmtD(c.date)}</td>\n                <td><span class=\"badge\" style=\"background:${ext?.couleur || \"#8B5CF6\"}22;color:${ext?.couleur || \"#8B5CF6\"};border:1px solid ${ext?.couleur || \"#8B5CF6\"}44\">${ext?.nom || \"—\"}</span></td>\n                <td>${c.nom}</td>\n                <td>${c.tel || \"—\"}</td>\n                <td><button class=\"btn btn-secondary btn-sm\" onclick=\"showRapModal('${c.rapId}')\">${icon(\"eye\")}</button></td>\n              </tr>`;\n            })\n            .join(\"\")}\n        </tbody>\n      </table>\n    </div>\n  `);\n}\n\nfunction pgAdminSettings() {\n  setActive(\"/admin/settings\");\n  setTopbar(\"Paramètres\", \"Configuration\", \"Admin\");\n  const cfg = Store.getSet();\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Paramètres</h1><p>Configuration globale</p></div>\n    </div>\n    <div class=\"grid-2 mb-20\">\n      <div class=\"card\">\n        <div class=\"form-section-title mb-12\">Identité du réseau</div>\n        <div class=\"form-row\">\n          <label>Nom de l'organisation</label>\n          <input id=\"set-nom\" value=\"${cfg.nom || \"\"}\" />\n        </div>\n        <div class=\"form-row\">\n          <label>Mot de passe administrateur</label>\n          <input id=\"set-admin-pw\" type=\"password\" value=\"${cfg.adminPw || \"\"}\" />\n        </div>\n        <button class=\"btn btn-primary mt-12\" onclick=\"saveSettings()\">${icon(\"save\")} Enregistrer</button>\n      </div>\n      <div class=\"card\">\n        <div class=\"form-section-title mb-12\">Logo</div>\n        <div class=\"form-row\">\n          <label>Charger un logo (PNG/JPG)</label>\n          <input type=\"file\" id=\"set-logo\" accept=\"image/*\" onchange=\"handleLogoUpload(this)\" />\n        </div>\n        ${Store.getLogo() ? `<button class=\"btn btn-danger btn-sm mt-8\" onclick=\"clearLogo()\">${icon(\"trash\")} Supprimer le logo</button>` : \"\"}\n      </div>\n    </div>\n    <div class=\"card\">\n      <div class=\"form-section-title mb-12\">Données</div>\n      <div class=\"flex gap-12\">\n        <button class=\"btn btn-secondary\" onclick=\"exportData()\">${icon(\"save\")} Exporter les données</button>\n        <button class=\"btn btn-secondary\" onclick=\"document.getElementById('import-file').click()\">${icon(\"upload\")} Importer les données</button>\n        <input type=\"file\" id=\"import-file\" accept=\".json\" class=\"hidden\" onchange=\"importData(this)\" />\n        <button class=\"btn btn-danger\" onclick=\"resetData()\">⚠ Réinitialiser tout</button>\n      </div>\n    </div>\n  `);\n}\n\nfunction saveSettings() {\n  const nom = (document.getElementById(\"set-nom\") as HTMLInputElement).value.trim();\n  const adminPw = (document.getElementById(\"set-admin-pw\") as HTMLInputElement).value.trim();\n  Store.saveSet({ nom, adminPw });\n  updateLogoUI();\n  toast(\"Paramètres enregistrés\", \"success\");\n}\n\nfunction handleLogoUpload(input: HTMLInputElement) {\n  const file = input.files?.[0];\n  if (!file) return;\n  const reader = new FileReader();\n  reader.onload = (e) => {\n    const data = e.target?.result as string;\n    Store.setLogo(data);\n    updateLogoUI();\n    toast(\"Logo mis à jour\", \"success\");\n    pgAdminSettings();\n  };\n  reader.readAsDataURL(file);\n}\n\nfunction clearLogo() {\n  Store.setLogo(null);\n  updateLogoUI();\n  toast(\"Logo supprimé\", \"success\");\n  pgAdminSettings();\n}\n\nfunction exportData() {\n  const data = {\n    extensions: Store.getExts(),\n    rapports: Store.getRaps(),\n    settings: Store.getSet(),\n  };\n  const blob = new Blob([JSON.stringify(data, null, 2)], { type: \"application/json\" });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement(\"a\");\n  a.href = url;\n  a.download = `churchreport_backup_${new Date().toISOString().split(\"T\")[0]}.json`;\n  a.click();\n  URL.revokeObjectURL(url);\n  toast(\"Données exportées\", \"success\");\n}\n\nfunction importData(input: HTMLInputElement) {\n  const file = input.files?.[0];\n  if (!file) return;\n  const reader = new FileReader();\n  reader.onload = (e) => {\n    try {\n      const data = JSON.parse(e.target?.result as string);\n      if (data.extensions) localStorage.setItem(\"eic_ext\", JSON.stringify(data.extensions));\n      if (data.rapports) localStorage.setItem(\"eic_rap\", JSON.stringify(data.rapports));\n      if (data.settings) localStorage.setItem(\"eic_set\", JSON.stringify(data.settings));\n      toast(\"Données importées\", \"success\");\n      location.reload();\n    } catch {\n      toast(\"Fichier invalide\", \"error\");\n    }\n  };\n  reader.readAsText(file);\n}\n\nfunction resetData() {\n  if (!confirm(\"Réinitialiser toutes les données ? Cette action est irréversible.\")) return;\n  localStorage.clear();\n  location.reload();\n}\n\nfunction pgExtDash(extId: string) {\n  setActive(\"/ext/dashboard\");\n  const ext = Store.getExt(extId);\n  const st = Store.stats(extId);\n  const mo = Store.monthly(extId, new Date().getFullYear());\n  setTopbar(\"Tableau de Bord\", ext?.nom || \"Mon Extension\", ext?.ville || \"\");\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Bienvenue</h1><p>${ext?.nom || \"\"}</p></div>\n      <button class=\"btn btn-primary\" onclick=\"navTo('/ext/new')\">${icon(\"plus\")} Nouveau Rapport</button>\n    </div>\n    <div class=\"grid-4 mb-20\">\n      ${statCard(\"fileText\", \"Cultes\", String(st.cultes), \"Total enregistrés\")}\n      ${statCard(\"users\", \"Présence moy.\", String(st.presence), \"Par culte\")}\n      ${statCard(\"wallet\", \"Offrandes\", fmt(st.offrandes, ext?.symbole || \"€\"), \"Total\")}\n      ${statCard(\"userCheck\", \"Convertis\", String(st.nouveaux), \"Total\")}\n    </div>\n    <div class=\"grid-2 mb-20\">\n      <div class=\"card\"><div class=\"form-section-title mb-12\">Présence mensuelle ${new Date().getFullYear()}</div><div class=\"chart-wrap\"><canvas id=\"chP\"></canvas></div></div>\n      <div class=\"card\"><div class=\"form-section-title mb-12\">Offrandes mensuelles ${new Date().getFullYear()}</div><div class=\"chart-wrap\"><canvas id=\"></div></divchO\"></canvas>\n    </div>\n  `);\n\n  const lb = mo.map((m) => m.lbl);\n  chartBar(\"chP\", lb, mo.map((m) => m.presence), \"Présence\", \"rgba(139,92,246,.7)\");\n  chartBar(\"chO\", lb, mo.map((m) => m.offrandes), \"Offrandes\", \"rgba(245,158,11,.7)\");\n}\n\nlet rapFormData: Rapport | null = null;\nlet rapStep = 0;\n\nfunction pgExtNew(extId: string) {\n  setActive(\"/ext/new\");\n  const ext = Store.getExt(extId);\n  setTopbar(\"Nouveau Rapport\", ext?.nom || \"\", \"\");\n\n  const params = curParams();\n  const rapId = params.rap;\n  if (rapId && rapFormData) {\n  } else {\n    rapFormData = {\n      id: uid(),\n      extensionId: extId,\n      date: new Date().toISOString().split(\"T\")[0],\n      heureDebut: \"09:00\",\n      heureFin: \"12:00\",\n      moderateur: ext?.coordinateur || \"\",\n      predicateur: ext?.pasteur.nom || \"\",\n      effectif: { papas: 0, mamans: 0, freres: 0, soeurs: 0, enfants: 0, total: 0 },\n      offrandes: { ordinaires: 0, orateur: 0, dimes: 0, actionsGrace: 0, total: 0 },\n      ventilation: { dixPctDime: 0, dixPctSocial: 0, reste: 0 },\n      depenses: [],\n      nouveaux: [],\n      signatures: { secretaire: ext?.secretaire || \"\", tresorier: ext?.tresorier || \"\", pasteur: ext?.pasteur.nom || \"\" },\n    };\n    rapStep = 0;\n  }\n\n  const sym = ext?.symbole || \"€\";\n  const steps = [\"Culte\", \"Effectif\", \"Offrandes\", \"Dépenses\", \"Convertis\", \"Signature\"];\n  const stepLabels = [\n    { icon: \"clock\", label: \"Culte\" },\n    { icon: \"users\", label: \"Effectif\" },\n    { icon: \"wallet\", label: \"Offrandes\" },\n    { icon: \"download\", label: \"Dépenses\" },\n    { icon: \"userCheck\", label: \"Convertis\" },\n    { icon: \"pen\", label: \"Signature\" },\n  ];\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Nouveau Rapport</h1><p>${ext?.nom || \"\"}</p></div>\n    </div>\n    <div class=\"stepper mb-20\">\n      ${steps\n        .map(\n          (s, i) =>\n            `<div class=\"step-item\">\n              <div class=\"step-dot ${i === rapStep ? \"s-active\" : \"\"} ${i < rapStep ? \"s-done\" : \"\"}\" onclick=\"goToStep(${i})\">${i < rapStep ? \"✓\" : i + 1}</div>\n              <span class=\"step-lbl ${i === rapStep ? \"s-active\" : \"\"}\">${icon(stepLabels[i].icon)} ${stepLabels[i].label}</span>\n            </div>${i < steps.length - 1 ? '<div class=\"step-connector\"></div>' : \"\"}`\n        )\n        .join(\"\")}\n    </div>\n    <div class=\"card\">\n      ${renderStepContent(rapFormData!, sym)}\n    </div>\n  `);\n}\n\nfunction goToStep(step: number) {\n  rapStep = step;\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") {\n    pgExtNew(ses.extId);\n  }\n}\n\nfunction renderStepContent(r: Rapport, sym: string): string {\n  switch (rapStep) {\n    case 0:\n      return `\n        <div class=\"form-section-title\">Informations du culte</div>\n        <div class=\"form-row cols-2\">\n          <div><label>Date *</label><input type=\"date\" id=\"rf-date\" value=\"${r.date}\" /></div>\n          <div><label>Thème</label><input type=\"text\" id=\"rf-theme\" value=\"${r.theme || \"\"}\" /></div>\n        </div>\n        <div class=\"form-row cols-2\">\n          <div><label>Heure de début</label><input type=\"time\" id=\"rf-begin\" value=\"${r.heureDebut || \"\"}\" /></div>\n          <div><label>Heure de fin</label><input type=\"time\" id=\"rf-end\" value=\"${r.heureFin || \"\"}\" /></div>\n        </div>\n        <div class=\"form-row cols-2\">\n          <div><label>Modérateur</label><input type=\"text\" id=\"rf-mod\" value=\"${r.moderateur || \"\"}\" /></div>\n          <div><label>Prédicateur</label><input type=\"text\" id=\"rf-pred\" value=\"${r.predicateur || \"\"}\" /></div>\n        </div>\n        <div class=\"form-row cols-2\">\n          <div><label>Interprète</label><input type=\"text\" id=\"rf-int\" value=\"${r.interprete || \"\"}\" /></div>\n          <div><label>Textes bibliques</label><input type=\"text\" id=\"rf-txt\" value=\"${r.textes || \"\"}\" /></div>\n        </div>\n        <div class=\"flex justify-between mt-16\">\n          <button class=\"btn btn-secondary\" onclick=\"navTo('/ext/dashboard')\">Annuler</button>\n          <button class=\"btn btn-primary\" onclick=\"saveStep0()\">Suivant →</button>\n        </div>`;\n    case 1:\n      return `\n        <div class=\"form-section-title\">Effectif des présents</div>\n        <div class=\"form-row cols-5\">\n          <div><label>Papas</label><input type=\"number\" id=\"rf-papas\" value=\"${r.effectif?.papas || 0}\" min=\"0\" onchange=\"updateEffTotal()\" /></div>\n          <div><label>Mamans</label><input type=\"number\" id=\"rf-mamans\" value=\"${r.effectif?.mamans || 0}\" min=\"0\" onchange=\"updateEffTotal()\" /></div>\n          <div><label>Frères</label><input type=\"number\" id=\"rf-freres\" value=\"${r.effectif?.freres || 0}\" min=\"0\" onchange=\"updateEffTotal()\" /></div>\n          <div><label>Soeurs</label><input type=\"number\" id=\"rf-soeurs\" value=\"${r.effectif?.soeurs || 0}\" min=\"0\" onchange=\"updateEffTotal()\" /></div>\n          <div><label>Enfants</label><input type=\"number\" id=\"rf-enfants\" value=\"${r.effectif?.enfants || 0}\" min=\"0\" onchange=\"updateEffTotal()\" /></div>\n        </div>\n        <div class=\"total-box mt-12\">\n          <span class=\"total-box-label\">Total présence</span>\n          <span class=\"total-box-value\" id=\"rf-eff-total\">${r.effectif?.total || 0}</span>\n        </div>\n        <div class=\"flex justify-between mt-16\">\n          <button class=\"btn btn-secondary\" onclick=\"goToStep(0)\">← Précédent</button>\n          <button class=\"btn btn-primary\" onclick=\"saveStep1()\">Suivant →</button>\n        </div>`;\n    case 2:\n      const tot = (r.offrandes?.ordinaires || 0) + (r.offrandes?.orateur || 0) + (r.offrandes?.dimes || 0) + (r.offrandes?.actionsGrace || 0);\n      return `\n        <div class=\"form-section-title\">Offrandes (${sym})</div>\n        <div class=\"form-row cols-2\">\n          <div><label>Offrandes ordinaires</label><input type=\"number\" id=\"rf-ord\" value=\"${r.offrandes?.ordinaires || 0}\" min=\"0\" onchange=\"updateOffTotals()\" /></div>\n          <div><label>Offrande orateur</label><input type=\"number\" id=\"rf-ora\" value=\"${r.offrandes?.orateur || 0}\" min=\"0\" onchange=\"updateOffTotals()\" /></div>\n        </div>\n        <div class=\"form-row cols-2\">\n          <div><label>Dîmes</label><input type=\"number\" id=\"rf-dim\" value=\"${r.offrandes?.dimes || 0}\" min=\"0\" onchange=\"updateOffTotals()\" /></div>\n          <div><label>Actions de grâce</label><input type=\"number\" id=\"rf-ag\" value=\"${r.offrandes?.actionsGrace || 0}\" min=\"0\" onchange=\"updateOffTotals()\" /></div>\n        </div>\n        <div class=\"total-box mt-12\">\n          <span class=\"total-box-label\">Total offrandes</span>\n          <span class=\"total-box-value\" id=\"rf-off-total\">${fmt(tot, sym)}</span>\n        </div>\n        <div class=\"form-section-title mt-20\">Ventilation</div>\n        <div class=\"calc-box\">\n          <div class=\"calc-row\"><span>10% des dîmes</span><span id=\"rf-vent-dim\">${fmt(r.ventilation?.dixPctDime || 0, sym)}</span></div>\n          <div class=\"calc-row\"><span>10% social (totale)</span><span id=\"rf-vent-soc\">${fmt(r.ventilation?.dixPctSocial || 0, sym)}</span></div>\n          <div class=\"calc-row\"><span>Reste</span><span id=\"rf-vent-reste\">${fmt(r.ventilation?.reste || 0, sym)}</span></div>\n        </div>\n        <div class=\"flex justify-between mt-16\">\n          <button class=\"btn btn-secondary\" onclick=\"goToStep(1)\">← Précédent</button>\n          <button class=\"btn btn-primary\" onclick=\"saveStep2()\">Suivant →</button>\n        </div>`;\n    case 3:\n      const totalDep = (r.depenses || []).reduce((s, d) => s + d.montant, 0);\n      return `\n        <div class=\"form-section-title\">Dépenses (${sym})</div>\n        <div id=\"dep-list\">\n          ${(r.depenses || []).map((d, i) => `<div class=\"dep-row\"><input type=\"text\" placeholder=\"Motif\" value=\"${d.motif}\" id=\"dep-mot-${i}\"><input type=\"number\" placeholder=\"Montant\" value=\"${d.montant}\" min=\"0\" id=\"dep-mon-${i}\" onchange=\"updateDepTotal(${i})\"><button class=\"btn btn-danger btn-icon\" onclick=\"removeDepRow(${i})\">${icon(\"x\")}</button></div>`).join(\"\")}\n        </div>\n        <button class=\"btn btn-secondary btn-sm mt-8\" onclick=\"addDepRow()\">${icon(\"plus\")} Ajouter une dépense</button>\n        <div class=\"total-box mt-12\">\n          <span class=\"total-box-label\">Total dépenses</span>\n          <span class=\"total-box-value\" id=\"rf-dep-total\">${fmt(totalDep, sym)}</span>\n        </div>\n        <div class=\"flex justify-between mt-16\">\n          <button class=\"btn btn-secondary\" onclick=\"goToStep(2)\">← Précédent</button>\n          <button class=\"btn btn-primary\" onclick=\"saveStep3()\">Suivant →</button>\n        </div>`;\n    case 4:\n      return `\n        <div class=\"form-section-title\">Nouveaux convertis</div>\n        <div id=\"conv-list\">\n          ${(r.nouveaux || []).map((n, i) => `<div class=\"conv-row\"><input type=\"text\" placeholder=\"Nom\" value=\"${n.nom}\" id=\"conv-nom-${i}\"><input type=\"text\" placeholder=\"Téléphone\" value=\"${n.tel || \"\"}\" id=\"conv-tel-${i}\"><button class=\"btn btn-danger btn-icon\" onclick=\"removeConvRow(${i})\">${icon(\"x\")}</button></div>`).join(\"\")}\n        </div>\n        <button class=\"btn btn-secondary btn-sm mt-8\" onclick=\"addConvRow()\">${icon(\"plus\")} Ajouter un converti</button>\n        <div class=\"flex justify-between mt-16\">\n          <button class=\"btn btn-secondary\" onclick=\"goToStep(3)\">← Précédent</button>\n          <button class=\"btn btn-primary\" onclick=\"saveStep4()\">Suivant →</button>\n        </div>`;\n    case 5:\n      return `\n        <div class=\"form-section-title\">Signatures</div>\n        <div class=\"form-row\">\n          <label>Secrétaire</label>\n          <input type=\"text\" id=\"rf-sec\" value=\"${r.signatures?.secretaire || \"\"}\" />\n        </div>\n        <div class=\"form-row\">\n          <label>Trésorier</label>\n          <input type=\"text\" id=\"rf-treso\" value=\"${r.signatures?.tresorier || \"\"}\" />\n        </div>\n        <div class=\"form-row\">\n          <label>Pasteur</label>\n          <input type=\"text\" id=\"rf-past\" value=\"${r.signatures?.pasteur || \"\"}\" />\n        </div>\n        <div class=\"flex justify-between mt-16\">\n          <button class=\"btn btn-secondary\" onclick=\"goToStep(4)\">← Précédent</button>\n          <button class=\"btn btn-primary\" onclick=\"saveStep5()\">${icon(\"save\")} Enregistrer</button>\n        </div>`;\n    default:\n      return \"\";\n  }\n}\n\nfunction saveStep0() {\n  if (!rapFormData) return;\n  rapFormData.date = (document.getElementById(\"rf-date\") as HTMLInputElement).value;\n  rapFormData.theme = (document.getElementById(\"rf-theme\") as HTMLInputElement).value;\n  rapFormData.heureDebut = (document.getElementById(\"rf-begin\") as HTMLInputElement).value;\n  rapFormData.heureFin = (document.getElementById(\"rf-end\") as HTMLInputElement).value;\n  rapFormData.moderateur = (document.getElementById(\"rf-mod\") as HTMLInputElement).value;\n  rapFormData.predicateur = (document.getElementById(\"rf-pred\") as HTMLInputElement).value;\n  rapFormData.interprete = (document.getElementById(\"rf-int\") as HTMLInputElement).value;\n  rapFormData.textes = (document.getElementById(\"rf-txt\") as HTMLInputElement).value;\n  rapStep = 1;\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n}\n\nfunction updateEffTotal() {\n  const p = parseInt((document.getElementById(\"rf-papas\") as HTMLInputElement).value) || 0;\n  const m = parseInt((document.getElementById(\"rf-mamans\") as HTMLInputElement).value) || 0;\n  const f = parseInt((document.getElementById(\"rf-freres\") as HTMLInputElement).value) || 0;\n  const s = parseInt((document.getElementById(\"rf-soeurs\") as HTMLInputElement).value) || 0;\n  const e = parseInt((document.getElementById(\"rf-enfants\") as HTMLInputElement).value) || 0;\n  document.getElementById(\"rf-eff-total\")!.textContent = String(p + m + f + s + e);\n}\n\nfunction saveStep1() {\n  if (!rapFormData) return;\n  rapFormData.effectif = {\n    papas: parseInt((document.getElementById(\"rf-papas\") as HTMLInputElement).value) || 0,\n    mamans: parseInt((document.getElementById(\"rf-mamans\") as HTMLInputElement).value) || 0,\n    freres: parseInt((document.getElementById(\"rf-freres\") as HTMLInputElement).value) || 0,\n    soeurs: parseInt((document.getElementById(\"rf-soeurs\") as HTMLInputElement).value) || 0,\n    enfants: parseInt((document.getElementById(\"rf-enfants\") as HTMLInputElement).value) || 0,\n    total: 0,\n  };\n  rapFormData.effectif.total =\n    rapFormData.effectif.papas +\n    rapFormData.effectif.mamans +\n    rapFormData.effectif.freres +\n    rapFormData.effectif.soeurs +\n    rapFormData.effectif.enfants;\n  rapStep = 2;\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n}\n\nfunction updateOffTotals() {\n  const ord = parseInt((document.getElementById(\"rf-ord\") as HTMLInputElement).value) || 0;\n  const ora = parseInt((document.getElementById(\"rf-ora\") as HTMLInputElement).value) || 0;\n  const dim = parseInt((document.getElementById(\"rf-dim\") as HTMLInputElement).value) || 0;\n  const ag = parseInt((document.getElementById(\"rf-ag\") as HTMLInputElement).value) || 0;\n  const tot = ord + ora + dim + ag;\n  const ext = Store.getExt(rapFormData?.extensionId || \"\");\n  const sym = ext?.symbole || \"€\";\n\n  document.getElementById(\"rf-off-total\")!.textContent = fmt(tot, sym);\n  document.getElementById(\"rf-vent-dim\")!.textContent = fmt(dim * 0.1, sym);\n  document.getElementById(\"rf-vent-soc\")!.textContent = fmt(tot * 0.1, sym);\n  document.getElementById(\"rf-vent-reste\")!.textContent = fmt(tot * 0.8, sym);\n}\n\nfunction saveStep2() {\n  if (!rapFormData) return;\n  const ord = parseInt((document.getElementById(\"rf-ord\") as HTMLInputElement).value) || 0;\n  const ora = parseInt((document.getElementById(\"rf-ora\") as HTMLInputElement).value) || 0;\n  const dim = parseInt((document.getElementById(\"rf-dim\") as HTMLInputElement).value) || 0;\n  const ag = parseInt((document.getElementById(\"rf-ag\") as HTMLInputElement).value) || 0;\n  const total = ord + ora + dim + ag;\n\n  rapFormData.offrandes = { ordinaires: ord, orateur: ora, dimes: dim, actionsGrace: ag, total };\n  rapFormData.ventilation = {\n    dixPctDime: +(dim * 0.1).toFixed(2),\n    dixPctSocial: +(total * 0.1).toFixed(2),\n    reste: +(total * 0.8).toFixed(2),\n  };\n  rapStep = 3;\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n}\n\nwindow.addDepRow = function () {\n  if (!rapFormData) return;\n  rapFormData.depenses = rapFormData.depenses || [];\n  rapFormData.depenses.push({ motif: \"\", montant: 0 });\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n};\n\nwindow.removeDepRow = function (idx: number) {\n  if (!rapFormData?.depenses) return;\n  rapFormData.depenses.splice(idx, 1);\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n};\n\nfunction saveStep3() {\n  if (!rapFormData) return;\n  const depRows = document.querySelectorAll(\".dep-row\");\n  const deps: { motif: string; montant: number }[] = [];\n  depRows.forEach((row, i) => {\n    const mot = (document.getElementById(`dep-mot-${i}`) as HTMLInputElement)?.value || \"\";\n    const mon = parseInt((document.getElementById(`dep-mon-${i}`) as HTMLInputElement)?.value) || 0;\n    if (mot) deps.push({ motif: mot, montant: mon });\n  });\n  rapFormData.depenses = deps;\n  rapFormData.totalDepenses = deps.reduce((s, d) => s + d.montant, 0);\n  rapFormData.soldeFinal = (rapFormData.offrandes?.total || 0) - rapFormData.totalDepenses;\n  rapStep = 4;\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n}\n\nwindow.addConvRow = function () {\n  if (!rapFormData) return;\n  rapFormData.nouveaux = rapFormData.nouveaux || [];\n  rapFormData.nouveaux.push({ nom: \"\", tel: \"\" });\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n};\n\nwindow.removeConvRow = function (idx: number) {\n  if (!rapFormData?.nouveaux) return;\n  rapFormData.nouveaux.splice(idx, 1);\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n};\n\nfunction saveStep4() {\n  if (!rapFormData) return;\n  const convRows = document.querySelectorAll(\".conv-row\");\n  const convs: { nom: string; tel?: string }[] = [];\n  convRows.forEach((_, i) => {\n    const nom = (document.getElementById(`conv-nom-${i}`) as HTMLInputElement)?.value || \"\";\n    const tel = (document.getElementById(`conv-tel-${i}`) as HTMLInputElement)?.value || \"\";\n    if (nom) convs.push({ nom, tel: tel || undefined });\n  });\n  rapFormData.nouveaux = convs;\n  rapStep = 5;\n  const ses = Auth.ses();\n  if (ses?.role === \"extension\") pgExtNew(ses.extId);\n}\n\nfunction saveStep5() {\n  if (!rapFormData) return;\n  rapFormData.signatures = {\n    secretaire: (document.getElementById(\"rf-sec\") as HTMLInputElement).value,\n    tresorier: (document.getElementById(\"rf-treso\") as HTMLInputElement).value,\n    pasteur: (document.getElementById(\"rf-past\") as HTMLInputElement).value,\n  };\n  Store.saveRap(rapFormData);\n  toast(\"Rapport enregistré avec succès\", \"success\");\n  rapFormData = null;\n  rapStep = 0;\n  navTo(\"/ext/rapports\");\n}\n\nfunction pgExtRaps(params: Record<string, string> = {}) {\n  setActive(\"/ext/rapports\");\n  const ses = Auth.ses();\n  if (!ses || ses.role !== \"extension\") return;\n  const extId = ses.extId;\n  const ext = Store.getExt(extId);\n  const fMonth = params.month !== undefined && params.month !== \"\" ? parseInt(params.month) : -1;\n  const fYear = params.year ? parseInt(params.year) : 0;\n\n  let raps = Store.getRaps(extId);\n  if (fMonth >= 0) raps = raps.filter((r) => new Date(r.date + \"T00:00\").getMonth() === fMonth);\n  if (fYear) raps = raps.filter((r) => new Date(r.date + \"T00:00\").getFullYear() === fYear);\n  raps.sort((a, b) => b.date.localeCompare(a.date));\n\n  setTopbar(\"Mes Rapports\", ext?.nom || \"\", \"\");\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Mes Rapports</h1><p>${raps.length} rapport(s)</p></div>\n      <button class=\"btn btn-primary\" onclick=\"navTo('/ext/new')\">${icon(\"plus\")} Nouveau</button>\n    </div>\n    <div class=\"filter-bar\">\n      <select onchange=\"extRapFilter(this,'month')\">\n        <option value=\"\">— Tous les mois —</option>\n        ${Array.from({ length: 12 }, (_, i) => `<option value=\"${i}\"${fMonth === i ? \" selected\" : \"\"}>${mName(i)}</option>`).join(\"\")}\n      </select>\n      <select onchange=\"extRapFilter(this,'year')\">\n        <option value=\"\">— Toutes années —</option>\n        ${[2026, 2025, 2024, 2023].map((y) => `<option value=\"${y}\"${fYear === y ? \" selected\" : \"\"}>${y}</option>`).join(\"\")}\n      </select>\n    </div>\n    <div class=\"table-wrap\">\n      <table>\n        <thead><tr><th>Date</th><th>Présence</th><th>Offrandes</th><th>Convertis</th><th>Actions</th></tr></thead>\n        <tbody>\n          ${raps.length === 0 ? `<tr><td colspan=\"5\" style=\"text-align:center;padding:32px;color:var(--text3)\">Aucun rapport</td></tr>` : \"\"}\n          ${raps\n            .map(\n              (r) => `<tr>\n            <td class=\"td-bold\">${fmtD(r.date)}</td>\n            <td>${r.effectif?.total || 0}</td>\n            <td>${fmt(r.offrandes?.total, ext?.symbole || \"€\")}</td>\n            <td>${r.nouveaux?.length || 0}</td>\n            <td>\n              <div class=\"flex gap-8\">\n                <button class=\"btn btn-secondary btn-sm btn-icon\" onclick=\"showRapModal('${r.id}')\" title=\"Voir\">${icon(\"eye\")}</button>\n                <button class=\"btn btn-danger btn-sm btn-icon\" onclick=\"doDeleteRap('${r.id}')\" title=\"Supprimer\">${icon(\"trash\")}</button>\n              </div>\n            </td>\n          </tr>`\n            )\n            .join(\"\")}\n        </tbody>\n      </table>\n    </div>\n  `);\n}\n\nwindow.extRapFilter = function (sel: HTMLSelectElement, field: string) {\n  const p = curParams();\n  if (sel.value !== \"\") p[field] = sel.value;\n  else delete p[field];\n  navTo(\"/ext/rapports\", p);\n};\n\nwindow.doDeleteRap = function (id: string) {\n  if (!confirm(\"Supprimer ce rapport ?\")) return;\n  Store.delRap(id);\n  toast(\"Rapport supprimé\", \"success\");\n  pgExtRaps();\n};\n\nfunction pgExtBilans(extId: string) {\n  setActive(\"/ext/bilans\");\n  const ext = Store.getExt(extId);\n  const st = Store.stats(extId);\n  const yr = new Date().getFullYear();\n  const mo = Store.monthly(extId, yr);\n\n  setTopbar(\"Bilans\", ext?.nom || \"\", \"\");\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Bilans</h1><p>${yr}</p></div>\n    </div>\n    <div class=\"grid-3 mb-20\">\n      <div class=\"card\" style=\"border-left:3px solid ${ext?.couleur}\">\n        <div class=\"calc-box\">\n          <div class=\"calc-row\"><span>Cultes</span><span>${st.cultes}</span></div>\n          <div class=\"calc-row\"><span>Présence moy.</span><span>${st.presence}</span></div>\n          <div class=\"calc-row\"><span>Offrandes</span><span>${fmt(st.offrandes, ext?.symbole || \"€\")}</span></div>\n          <div class=\"calc-row total-row\"><span>Convertis</span><span>${st.nouveaux}</span></div>\n        </div>\n      </div>\n    </div>\n    <div class=\"card mb-20\">\n      <div class=\"form-section-title mb-12\">Présence mensuelle (${yr})</div>\n      <div class=\"chart-wrap\" style=\"height:200px\"><canvas id=\"chM\"></canvas></div>\n    </div>\n    <div class=\"form-section-title mb-12\">Détails mensuels</div>\n    <div class=\"table-wrap\">\n      <table>\n        <thead><tr><th>Mois</th><th>Cultes</th><th>Présence</th><th>Offrandes</th><th>Convertis</th></tr></thead>\n        <tbody>\n          ${mo\n            .map(\n              (m) => `<tr>\n            <td class=\"td-bold\">${m.lbl} ${yr}</td>\n            <td>${m.cultes}</td>\n            <td>${m.presence}</td>\n            <td>${fmt(m.offrandes, ext?.symbole || \"€\")}</td>\n            <td>${m.nouveaux}</td>\n          </tr>`\n            )\n            .join(\"\")}\n        </tbody>\n      </table>\n    </div>\n  `);\n\n  chartBar(\"chM\", mo.map((m) => m.lbl), mo.map((m) => m.presence), \"Présence\", \"rgba(139,92,246,.7)\");\n}\n\nfunction pgExtConvertis(extId: string) {\n  setActive(\"/ext/convertis\");\n  const ext = Store.getExt(extId);\n  const convertis = Store.allNouveaux(extId);\n\n  setTopbar(\"Convertis\", ext?.nom || \"\", \"\");\n\n  render(`\n    <div class=\"page-header\">\n      <div><h1>Nouveaux Convertis</h1><p>${convertis.length} converti(s)</p></div>\n    </div>\n    <div class=\"table-wrap\">\n      <table>\n        <thead><tr><th>Date</th><th>Nom</th><th>Téléphone</th><th>Actions</th></tr></thead>\n        <tbody>\n          ${convertis.length === 0 ? `<tr><td colspan=\"4\" style=\"text-align:center;padding:32px;color:var(--text3)\">Aucun converti</td></tr>` : \"\"}\n          ${convertis\n            .map(\n              (c) => `<tr>\n            <td class=\"td-bold\">${fmtD(c.date)}</td>\n            <td>${c.nom}</td>\n            <td>${c.tel || \"—\"}</td>\n            <td><button class=\"btn btn-secondary btn-sm\" onclick=\"showRapModal('${c.rapId}')\">${icon(\"eye\")}</button></td>\n          </tr>`\n            )\n            .join(\"\")}\n        </tbody>\n      </table>\n    </div>\n  `);\n}\n\nwindow.confirmDelExt = function (id: string) {\n  const ext = Store.getExt(id);\n  if (!ext) return;\n  openModal(\n    `<div class=\"modal-header\"><h2>Supprimer l'extension</h2><button class=\"modal-close\" onclick=\"closeModal()\">${icon(\"x\")}</button></div>\n    <div class=\"modal-body\"><p style=\"color:var(--text2)\">Supprimer <strong style=\"color:var(--text)\">${ext.nom}</strong> et tous ses rapports ? Action irréversible.</p></div>\n    <div class=\"modal-footer\">\n      <button class=\"btn btn-secondary\" onclick=\"closeModal()\">Annuler</button>\n      <button class=\"btn btn-danger\" onclick=\"closeModal();Store.delExt('${id}');toast('Extension supprimée','success');pgAdminExts()\">Confirmer</button>\n    </div>`\n  );\n};\n\nwindow.openExtForm = function (extId: string | null) {\n  const e = extId ? Store.getExt(extId) : null;\n  const isEdit = !!extId;\n  openModal(\n    `<div class=\"modal-header\"><h2>${isEdit ? \"Modifier\" : \"Nouvelle\"} Extension</h2><button class=\"modal-close\" onclick=\"closeModal()\">${icon(\"x\")}</button></div>\n    <div class=\"modal-body\">\n      <div class=\"form-section-title mb-12\">Identité</div>\n      <div class=\"form-row cols-2\">\n        <div><label>Nom de l'extension *</label><input id=\"ef-nom\" value=\"${e?.nom || \"\"}\"/></div>\n        <div><label>Date de création</label><input id=\"ef-date\" type=\"date\" value=\"${e?.dateCreation || \"\"}\"/></div>\n      </div>\n      <div class=\"form-row cols-3\">\n        <div><label>Couleur</label><input id=\"ef-col\" type=\"color\" value=\"${e?.couleur || \"#8B5CF6\"}\"/></div>\n        <div><label>Devise</label><select id=\"ef-dev\" onchange=\"onDevChange()\">\n          ${DEVISES.map((d) => `<option value=\"${d.c}\" data-s=\"${d.s}\" ${e?.devise === d.c ? \"selected\" : \"\"}>${d.c} — ${d.s}</option>`).join(\"\")}\n        </select></div>\n        <div><label>Symbole</label><input id=\"ef-sym\" value=\"${e?.symbole || \"€\"}\" placeholder=\"€\"/></div>\n      </div>\n      <div class=\"form-section-title mb-12\">Localisation</div>\n      <div class=\"form-row\"><label>Adresse complète</label><input id=\"ef-addr\" value=\"${e?.adresse || \"\"}\"/></div>\n      <div class=\"form-row cols-2\">\n        <div><label>Ville</label><input id=\"ef-ville\" value=\"${e?.ville || \"\"}\"/></div>\n        <div><label>Pays</label><input id=\"ef-pays\" value=\"${e?.pays || \"\"}\"/></div>\n      </div>\n      <div class=\"form-section-title mb-12\">Équipe Pastorale</div>\n      <div class=\"form-row cols-2\">\n        <div><label>Pasteur Principal</label><input id=\"ef-past\" value=\"${e?.pasteur?.nom || \"\"}\"/></div>\n        <div><label>Email du Pasteur</label><input id=\"ef-email\" type=\"email\" value=\"${e?.pasteur?.email || \"\"}\"/></div>\n      </div>\n      <div class=\"form-row cols-2\">\n        <div><label>Téléphone</label><input id=\"ef-tel\" value=\"${e?.pasteur?.tel || \"\"}\"/></div>\n        <div><label>Coordinateur</label><input id=\"ef-coord\" value=\"${e?.coordinateur || \"\"}\"/></div>\n      </div>\n      <div class=\"form-row cols-2\">\n        <div><label>Secrétaire</label><input id=\"ef-sec\" value=\"${e?.secretaire || \"\"}\"/></div>\n        <div><label>Trésorier</label><input id=\"ef-tres\" value=\"${e?.tresorier || \"\"}\"/></div>\n      </div>\n      <div class=\"form-section-title mb-12\">Accès</div>\n      <div class=\"form-row cols-2\">\n        <div><label>Mot de passe *</label><input id=\"ef-pw\" value=\"${e?.password || \"\"}\"/></div>\n        <div></div>\n      </div>\n    </div>\n    <div class=\"modal-footer\">\n      <button class=\"btn btn-secondary\" onclick=\"closeModal()\">Annuler</button>\n      <button class=\"btn btn-primary\" onclick=\"saveExtForm('${extId || \"\"}')\">${icon(\"save\")} Enregistrer</button>\n    </div>`,\n    true\n  );\n};\n\nwindow.onDevChange = function () {\n  const sel = document.getElementById(\"ef-dev\") as HTMLSelectElement;\n  const opt = sel.options[sel.selectedIndex];\n  const sym = document.getElementById(\"ef-sym\") as HTMLInputElement;\n  if (sym && opt) sym.value = opt.dataset.s || \"\";\n};\n\nwindow.saveExtForm = function (extId: string) {\n  const g = (id: string) => (document.getElementById(id) as HTMLInputElement)?.value?.trim() || \"\";\n  const nom = g(\"ef-nom\");\n  if (!nom) {\n    toast(\"Le nom est obligatoire\", \"error\");\n    return;\n  }\n  const pw = g(\"ef-pw\");\n  if (!pw) {\n    toast(\"Mot de passe obligatoire\", \"error\");\n    return;\n  }\n  const ext: Extension = {\n    id: extId || \"ext_\" + Date.now(),\n    nom,\n    dateCreation: g(\"ef-date\"),\n    couleur: g(\"ef-col\") || \"#8B5CF6\",\n    devise: (document.getElementById(\"ef-dev\") as HTMLSelectElement)?.value || \"EUR\",\n    symbole: g(\"ef-sym\") || \"€\",\n    adresse: g(\"ef-addr\"),\n    ville: g(\"ef-ville\"),\n    pays: g(\"ef-pays\"),\n    pasteur: { nom: g(\"ef-past\"), email: g(\"ef-email\"), tel: g(\"ef-tel\") },\n    coordinateur: g(\"ef-coord\"),\n    secretaire: g(\"ef-sec\"),\n    tresorier: g(\"ef-tres\"),\n    password: pw,\n  };\n  Store.saveExt(ext);\n  closeModal();\n  toast(`Extension \"${nom}\" enregistrée`, \"success\");\n  pgAdminExts();\n};\n\nwindow.adminRapFilter = function (sel: HTMLSelectElement, field: string) {\n  const p = curParams();\n  if (sel.value !== \"\") p[field] = sel.value;\n  else delete p[field];\n  navTo(\"/admin/rapports\", p);\n};\n\nwindow.showRapModal = showRapModal;\nwindow.doExportPDF = doExportPDF;\nwindow.doExportDOCX = doExportDOCX;\n\nexport function initApp() {\n  seedIfNeeded();\n\n  window.switchTab = function (tab: string) {\n    document.querySelectorAll(\".login-tab\").forEach((t, i) => {\n      t.classList.toggle(\"active\", i === (tab === \"extension\" ? 0 : 1));\n    });\n    document.getElementById(\"panel-extension\")!.classList.toggle(\"active\", tab === \"extension\");\n    document.getElementById(\"panel-admin\")!.classList.toggle(\"active\", tab === \"admin\");\n  };\n\n  window.doLogin = function (type: string) {\n    const err = document.getElementById(\"login-error\")!;\n    err.style.display = \"none\";\n    if (type === \"admin\") {\n      const pw = (document.getElementById(\"admin-pw\") as HTMLInputElement).value;\n      if (Auth.loginAdmin(pw)) {\n        startApp();\n      } else {\n        err.textContent = \"Mot de passe incorrect.\";\n        err.style.display = \"block\";\n      }\n    } else {\n      const id = (document.getElementById(\"ext-select\") as HTMLSelectElement).value;\n      const pw = (document.getElementById(\"ext-pw\") as HTMLInputElement).value;\n      if (Auth.loginExt(id, pw)) {\n        startApp();\n      } else {\n        err.textContent = \"Extension ou mot de passe incorrect.\";\n        err.style.display = \"block\";\n      }\n    }\n  };\n\n  window.doLogout = function () {\n    Auth.logout();\n    location.reload();\n  };\n\n  window.toggleSidebar = function () {\n    document.getElementById(\"sidebar\")!.classList.toggle(\"open\");\n  };\n\n  window.navTo = navTo;\n  window.curPath = curPath;\n  window.curParams = curParams;\n  window.goToStep = goToStep;\n\n  const ses = Auth.ses();\n  if (ses) {\n    startApp();\n    return;\n  }\n\n  populateExtSel();\n  updateLogoUI();\n}\n","import \"./styles/app.css\";\r\nimport { initApp } from \"./app/index\";\r\n\r\ninitApp();\r\n\r\n"],"names":["K","DEVISES","DEF_EXTS","ADMIN_NAV","EXT_NAV","seedIfNeeded","raps","ext","m","day","dt","pres","tot","dimes","ord","or","ag","nCount","dep","_","i","Store","id","a","e","r","extId","x","s","d","n","_a","yr","mi","_b","_c","Auth","pw","cfg","fmt","v","sym","fmtD","uid","mName","ICONS","icon","name","_routes","regRoute","path","fn","navTo","params","q","curPath","curParams","initRouter","dispatch","p","setTopbar","title","sub","badge","render","html","buildNav","def","nav","g","it","setActive","el","toast","msg","type","w","openModal","large","closeModal","updateLogoUI","logo","wrap","li","sbn","populateExtSel","sel","startApp","ses","registerAdminRoutes","extSes","registerExtRoutes","statCard","iconName","label","value","chartBar","labels","data","color","ctx","chartLine","datasets","extCard","_d","_e","_f","rapTableRow","showRapModal","rapId","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","doExportPDF","jsPDF","doc","pageWidth","y","doExportDOCX","Document","Packer","Paragraph","TextRun","Table","TableRow","TableCell","WidthType","AlignmentType","BorderStyle","tableRows","blob","url","pgAdminDash","pgAdminExts","pgAdminRaps","pgAdminBilans","pgAdminConvertis","pgAdminSettings","pgExtDash","pgExtNew","pgExtRaps","pgExtBilans","pgExtConvertis","exts","st","mo","maxC","lb","fExt","fMonth","fYear","b","vals","convertis","c","rapFormData","rapStep","steps","stepLabels","renderStepContent","goToStep","step","_q","totalDep","_r","_s","_t","idx","field","opt","nom","initApp","tab","t","err"],"mappings":"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"}