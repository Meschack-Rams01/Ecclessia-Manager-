*{box-sizing:border-box;margin:0;padding:0;}
:root{
  --bg:#0C0A14;--surface:#131020;--surface2:#1A1630;--surface3:#211D3A;
  --border:#2A2550;--accent:#8B5CF6;--accent2:#A78BFA;--accent3:#C4B5FD;
  --gold:#F59E0B;--success:#10B981;--danger:#EF4444;
  --text:#F1EFF8;--text2:#A199C4;--text3:#5A5280;
  --font-display:'Cinzel',serif;--font-body:'DM Sans',sans-serif;
  --sidebar:260px;--header:60px;--radius:12px;
  --shadow:0 4px 24px rgba(139,92,246,.15);
}
html,body{height:100%;font-family:var(--font-body);background:var(--bg);color:var(--text);overflow:hidden;}
::-webkit-scrollbar{width:5px;height:5px;}
::-webkit-scrollbar-track{background:var(--surface);}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px;}

/* LAYOUT */
#app{display:flex;height:100vh;overflow:hidden;}
#sidebar{width:var(--sidebar);min-width:var(--sidebar);background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;transition:transform .3s;z-index:100;overflow:hidden;}
#main{flex:1;display:flex;flex-direction:column;overflow:hidden;min-width:0;}
#topbar{height:var(--header);background:var(--surface);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 20px;gap:12px;flex-shrink:0;}
#content{flex:1;overflow-y:auto;padding:24px;}

/* SIDEBAR */
.sidebar-logo{padding:18px 16px 14px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--border);flex-shrink:0;}
.logo-placeholder{width:34px;height:34px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--gold));display:flex;align-items:center;justify-content:center;font-size:16px;color:#fff;flex-shrink:0;}
.logo-img-wrap{width:34px;height:34px;border-radius:8px;overflow:hidden;flex-shrink:0;}
.logo-img-wrap img{width:100%;height:100%;object-fit:cover;}
.logo-text span:first-child{display:block;font-family:var(--font-display);font-size:10.5px;color:var(--text);font-weight:600;letter-spacing:.4px;}
.logo-text span:last-child{display:block;font-size:10px;color:var(--text3);}
.sidebar-badge{margin:10px 12px;background:var(--surface3);border:1px solid var(--border);border-radius:10px;padding:9px 12px;flex-shrink:0;}
.sidebar-badge .ext-name{font-size:12px;font-weight:600;color:var(--accent3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.sidebar-badge .ext-role{font-size:10px;color:var(--text3);}
.sidebar-nav{flex:1;overflow-y:auto;padding:6px 0;}
.nav-group{padding:8px 14px 2px;font-size:10px;font-weight:600;letter-spacing:1.5px;color:var(--text3);text-transform:uppercase;}
.nav-item{display:flex;align-items:center;gap:10px;padding:9px 16px;margin:1px 8px;border-radius:9px;cursor:pointer;font-size:13px;color:var(--text2);transition:all .15s;border:none;background:none;width:calc(100% - 16px);text-align:left;font-family:var(--font-body);}
.nav-item:hover{background:var(--surface3);color:var(--text);}
.nav-item.active{background:linear-gradient(135deg,rgba(139,92,246,.22),rgba(167,139,250,.08));color:var(--accent3);border:1px solid rgba(139,92,246,.28);}
.nav-icon{width:18px;text-align:center;font-size:14px;}
.sidebar-footer{padding:12px;border-top:1px solid var(--border);flex-shrink:0;}
.btn-logout{width:100%;padding:8px;background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.25);border-radius:9px;color:#EF4444;font-size:12px;cursor:pointer;font-family:var(--font-body);transition:all .2s;}
.btn-logout:hover{background:rgba(239,68,68,.2);}

/* TOPBAR */
.topbar-title{font-family:var(--font-display);font-size:14px;font-weight:600;color:var(--text);}
.topbar-sub{font-size:11px;color:var(--text3);}
.topbar-right{margin-left:auto;display:flex;align-items:center;gap:10px;}
.topbar-badge{background:var(--surface3);border:1px solid var(--border);border-radius:20px;padding:4px 12px;font-size:11px;color:var(--text2);}
.menu-btn{background:none;border:none;color:var(--text3);cursor:pointer;font-size:20px;padding:4px;display:none;}

/* CARDS */
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:20px;}
.stat-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:20px;position:relative;overflow:hidden;}
.stat-card::before{content:'';position:absolute;top:-20px;right:-20px;width:80px;height:80px;border-radius:50%;opacity:.06;background:var(--accent);}
.stat-label{font-size:10.5px;color:var(--text3);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px;}
.stat-value{font-family:var(--font-display);font-size:24px;color:var(--text);font-weight:700;line-height:1.2;}
.stat-sub{font-size:11px;color:var(--text3);margin-top:4px;}
.stat-icon{position:absolute;top:16px;right:16px;font-size:20px;opacity:.35;}

/* GRIDS */
.grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;}
.grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;}
.grid-auto{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:14px;}

/* FORM */
.form-section-title{font-family:var(--font-display);font-size:11px;color:var(--accent3);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:12px;padding-bottom:6px;border-bottom:1px solid var(--border);}
.form-row{display:grid;gap:12px;margin-bottom:12px;}
.cols-2{grid-template-columns:1fr 1fr;}
.cols-3{grid-template-columns:1fr 1fr 1fr;}
.cols-5{grid-template-columns:repeat(5,1fr);}
label{display:block;font-size:10.5px;color:var(--text3);text-transform:uppercase;letter-spacing:.7px;margin-bottom:5px;}
input,select,textarea{width:100%;background:var(--surface3);border:1px solid var(--border);border-radius:8px;padding:9px 12px;color:var(--text);font-family:var(--font-body);font-size:13px;outline:none;transition:border-color .2s;}
input:focus,select:focus,textarea:focus{border-color:var(--accent);}
select option{background:var(--surface3);color:var(--text);}
textarea{resize:vertical;min-height:80px;}
input[type="color"]{padding:2px 4px;height:38px;cursor:pointer;}
input[type="number"]{-moz-appearance:textfield;}
input[type="number"]::-webkit-outer-spin-button,input[type="number"]::-webkit-inner-spin-button{-webkit-appearance:none;}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 16px;border-radius:9px;font-family:var(--font-body);font-size:13px;font-weight:500;cursor:pointer;border:none;transition:all .2s;white-space:nowrap;text-decoration:none;}
.btn-primary{background:linear-gradient(135deg,var(--accent),#7C3AED);color:#fff;box-shadow:0 4px 14px rgba(139,92,246,.3);}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(139,92,246,.4);}
.btn-secondary{background:var(--surface3);color:var(--text2);border:1px solid var(--border);}
.btn-secondary:hover{background:var(--surface2);color:var(--text);}
.btn-danger{background:rgba(239,68,68,.12);color:#EF4444;border:1px solid rgba(239,68,68,.3);}
.btn-danger:hover{background:rgba(239,68,68,.22);}
.btn-success{background:rgba(16,185,129,.12);color:#10B981;border:1px solid rgba(16,185,129,.3);}
.btn-success:hover{background:rgba(16,185,129,.22);}
.btn-gold{background:linear-gradient(135deg,var(--gold),#D97706);color:#fff;}
.btn-gold:hover{transform:translateY(-1px);}
.btn-sm{padding:6px 11px;font-size:12px;}
.btn-icon{padding:7px;border-radius:8px;}
.w-full{width:100%;justify-content:center;}

/* TABLE */
.table-wrap{overflow-x:auto;border-radius:var(--radius);border:1px solid var(--border);}
table{width:100%;border-collapse:collapse;}
thead tr{background:var(--surface3);}
th{padding:10px 14px;font-size:10.5px;font-weight:600;color:var(--text3);text-transform:uppercase;letter-spacing:.7px;text-align:left;white-space:nowrap;}
td{padding:10px 14px;font-size:13px;color:var(--text2);border-top:1px solid var(--border);}
tbody tr:hover td{background:rgba(139,92,246,.05);color:var(--text);}
.td-bold{font-weight:600;color:var(--text);}

/* BADGES */
.badge{display:inline-flex;align-items:center;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;}
.badge-purple{background:rgba(139,92,246,.18);color:var(--accent3);border:1px solid rgba(139,92,246,.28);}
.badge-green{background:rgba(16,185,129,.12);color:#10B981;border:1px solid rgba(16,185,129,.25);}
.badge-gold{background:rgba(245,158,11,.12);color:var(--gold);border:1px solid rgba(245,158,11,.25);}

/* PAGE HEADER */
.page-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:22px;gap:12px;}
.page-header h1{font-family:var(--font-display);font-size:20px;color:var(--text);}
.page-header p{font-size:12px;color:var(--text3);margin-top:3px;}

/* MODAL */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.72);backdrop-filter:blur(5px);z-index:1000;display:flex;align-items:center;justify-content:center;padding:20px;}
.modal{background:var(--surface);border:1px solid var(--border);border-radius:16px;width:100%;max-width:680px;max-height:90vh;overflow:hidden;display:flex;flex-direction:column;}
.modal-lg{max-width:860px;}
.modal-header{padding:18px 22px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;flex-shrink:0;}
.modal-header h2{font-family:var(--font-display);font-size:15px;color:var(--text);}
.modal-body{padding:22px;overflow-y:auto;flex:1;}
.modal-footer{padding:14px 22px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:10px;flex-shrink:0;}
.modal-close{background:none;border:none;color:var(--text3);cursor:pointer;font-size:20px;padding:4px;line-height:1;}
.modal-close:hover{color:var(--text);}

/* LOGIN */
#login-screen{position:fixed;inset:0;background:var(--bg);z-index:9999;display:flex;align-items:center;justify-content:center;overflow-y:auto;}
.login-wrap{width:100%;max-width:400px;padding:20px;}
.login-logo{text-align:center;margin-bottom:28px;}
.login-icon{width:64px;height:64px;border-radius:16px;background:linear-gradient(135deg,var(--accent),var(--gold));display:inline-flex;align-items:center;justify-content:center;font-size:28px;margin-bottom:12px;overflow:hidden;}
.login-icon img{width:100%;height:100%;object-fit:cover;}
.login-logo h1{font-family:var(--font-display);font-size:20px;color:var(--text);}
.login-logo p{font-size:12px;color:var(--text3);margin-top:4px;}
.login-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:26px;}
.login-tabs{display:flex;gap:8px;margin-bottom:18px;}
.login-tab{flex:1;padding:9px;border-radius:9px;border:1px solid var(--border);background:none;color:var(--text3);font-family:var(--font-body);font-size:13px;cursor:pointer;transition:all .2s;}
.login-tab.active{background:rgba(139,92,246,.18);color:var(--accent3);border-color:var(--accent);}
.login-error{background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.3);border-radius:8px;padding:10px 14px;font-size:12px;color:#EF4444;margin-bottom:14px;display:none;}
.login-panel{display:none;}
.login-panel.active{display:block;}

/* EXT CARD */
.ext-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:18px;transition:all .2s;position:relative;overflow:hidden;}
.ext-card::after{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--ext-color,var(--accent));}
.ext-card:hover{border-color:var(--ext-color,var(--accent));transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.3);}
.ext-card-name{font-family:var(--font-display);font-size:14px;color:var(--text);margin-bottom:3px;}
.ext-card-ville{font-size:11px;color:var(--text3);margin-bottom:10px;}
.ext-mini-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;text-align:center;}
.ext-stat-val{font-size:17px;font-weight:700;color:var(--text);}
.ext-stat-lbl{font-size:10px;color:var(--text3);}

/* PROGRESS */
.progress-bar{height:5px;background:var(--surface3);border-radius:4px;overflow:hidden;}
.progress-fill{height:100%;border-radius:4px;transition:width .5s ease;}

/* RAPPORT UI */
.total-box{background:var(--surface3);border:1px solid var(--accent);border-radius:10px;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;}
.total-box-label{font-size:11px;color:var(--text3);}
.total-box-value{font-family:var(--font-display);font-size:17px;color:var(--accent3);}
.calc-box{background:var(--surface3);border-radius:10px;padding:12px 16px;font-size:13px;}
.calc-row{display:flex;justify-content:space-between;padding:3px 0;color:var(--text2);}
.calc-row.total-row{color:var(--accent3);font-weight:600;border-top:1px solid var(--border);margin-top:5px;padding-top:7px;}

/* STEPPER */
.stepper{display:flex;align-items:center;margin-bottom:22px;gap:0;}
.step-item{display:flex;align-items:center;flex:1;}
.step-dot{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;border:2px solid var(--border);color:var(--text3);background:var(--surface3);transition:all .3s;flex-shrink:0;cursor:pointer;}
.step-dot.s-active{border-color:var(--accent);color:var(--accent3);background:rgba(139,92,246,.15);}
.step-dot.s-done{border-color:var(--success);color:#10B981;background:rgba(16,185,129,.12);}
.step-lbl{font-size:10px;color:var(--text3);margin-left:6px;white-space:nowrap;}
.step-lbl.s-active{color:var(--accent3);}
.step-connector{flex:1;height:1px;background:var(--border);margin:0 8px;}

/* DYNAMIC ROWS */
.dep-row,.conv-row{display:grid;gap:8px;align-items:center;margin-bottom:8px;}
.dep-row{grid-template-columns:1fr 130px auto;}
.conv-row{grid-template-columns:1fr 1fr auto;}

/* CHART */
.chart-wrap{position:relative;height:220px;}

/* FILTER BAR */
.filter-bar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:14px;}
.filter-bar input,.filter-bar select{width:auto;flex:1;min-width:130px;}

/* UTILS */
.flex{display:flex;}.items-center{align-items:center;}.justify-between{justify-content:space-between;}.gap-8{gap:8px;}.gap-12{gap:12px;}.gap-16{gap:16px;}
.mt-4{margin-top:4px;}.mt-8{margin-top:8px;}.mt-12{margin-top:12px;}.mt-16{margin-top:16px;}.mt-20{margin-top:20px;}
.mb-8{margin-bottom:8px;}.mb-12{margin-bottom:12px;}.mb-16{margin-bottom:16px;}.mb-20{margin-bottom:20px;}
.text-sm{font-size:13px;}.text-xs{font-size:11px;}.text-muted{color:var(--text3);}.text-accent{color:var(--accent3);}.font-bold{font-weight:600;}
.hidden{display:none!important;}

/* TOAST */
#toast-wrap{position:fixed;bottom:20px;right:20px;z-index:9999;display:flex;flex-direction:column;gap:8px;pointer-events:none;}
.toast{background:var(--surface3);border:1px solid var(--border);border-radius:10px;padding:11px 16px;font-size:13px;color:var(--text);display:flex;align-items:center;gap:10px;min-width:220px;animation:toastIn .3s ease;box-shadow:var(--shadow);}
.toast.t-success{border-color:rgba(16,185,129,.4);background:rgba(16,185,129,.1);color:#10B981;}
.toast.t-error{border-color:rgba(239,68,68,.4);background:rgba(239,68,68,.1);color:#EF4444;}
@keyframes toastIn{from{transform:translateX(110%);opacity:0;}to{transform:translateX(0);opacity:1;}}
@keyframes toastOut{to{transform:translateX(110%);opacity:0;}}

/* RESPONSIVE */
@media(max-width:900px){
  #sidebar{position:fixed;top:0;bottom:0;left:0;transform:translateX(-100%);}
  #sidebar.open{transform:translateX(0);}
  .menu-btn{display:block;}
  .grid-4{grid-template-columns:repeat(2,1fr);}
  .grid-3{grid-template-columns:repeat(2,1fr);}
}
@media(max-width:580px){
  .grid-4,.grid-3,.grid-2{grid-template-columns:1fr;}
  #content{padding:14px;}
  .page-header{flex-direction:column;}
  .cols-5{grid-template-columns:repeat(2,1fr);}
}

